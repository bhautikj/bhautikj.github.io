!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,e.vrEmbed=t()}}(function(){var t;return function e(t,i,n){function r(o,a){if(!i[o]){if(!t[o]){var u="function"==typeof require&&require;if(!a&&u)return u(o,!0);if(s)return s(o,!0);var A=new Error("Cannot find module '"+o+"'");throw A.code="MODULE_NOT_FOUND",A}var c=i[o]={exports:{}};t[o][0].call(c.exports,function(e){var i=t[o][1][e];return r(i?i:e)},c,c.exports,e,t,i,n)}return i[o].exports}for(var s="function"==typeof require&&require,o=0;o<n.length;o++)r(n[o]);return r}({1:[function(t,e,i){var n=function(){function t(){n?document.removeEventListener("DOMContentLoaded",t,!0):"complete"===document.readyState&&document.detachEvent("onreadystatechange",t),i()}function e(){if(!r){try{document.documentElement.doScroll("left")}catch(t){return void window.setTimeout(arguments.callee,15)}i()}}function i(){if(!r){r=!0;for(var t=o.length,e=0;t>e;e++)o[e].call(document)}}var n=!!document.addEventListener,r=!1,s=!1,o=[];if(n)document.addEventListener("DOMContentLoaded",t,!0),window.addEventListener("load",i,!1);else{document.attachEvent("onreadystatechange",t),window.attachEvent("onload",i);try{s=null===window.frameElement}catch(a){}document.documentElement.doScroll&&s&&e()}return function(t){return r?t.call(document):o.push(t)}}();e.exports=n},{}],2:[function(t,e,i){function n(){this.callbacks={}}n.prototype.emit=function(t){var e=this.callbacks[t];if(!e)return void console.log("No valid callback specified.");var i=[].slice.call(arguments);i.shift();for(var n=0;n<e.length;n++)e[n].apply(this,i)},n.prototype.on=function(t,e){t in this.callbacks?this.callbacks[t].push(e):this.callbacks[t]=[e]},e.exports=n},{}],3:[function(e,i,n){!function(e,n){"function"==typeof t&&t.amd&&t([],n),"undefined"!=typeof i&&i.exports?i.exports=n():e.twgl=n()}(this,function(){var t,e,i;return function(n){function r(t,e){return w.call(t,e)}function s(t,e){var i,n,r,s,o,a,u,A,c,l,h,d=e&&e.split("/"),f=m.map,M=f&&f["*"]||{};if(t&&"."===t.charAt(0))if(e){for(t=t.split("/"),o=t.length-1,m.nodeIdCompat&&x.test(t[o])&&(t[o]=t[o].replace(x,"")),t=d.slice(0,d.length-1).concat(t),c=0;c<t.length;c+=1)if(h=t[c],"."===h)t.splice(c,1),c-=1;else if(".."===h){if(1===c&&(".."===t[2]||".."===t[0]))break;c>0&&(t.splice(c-1,2),c-=2)}t=t.join("/")}else 0===t.indexOf("./")&&(t=t.substring(2));if((d||M)&&f){for(i=t.split("/"),c=i.length;c>0;c-=1){if(n=i.slice(0,c).join("/"),d)for(l=d.length;l>0;l-=1)if(r=f[d.slice(0,l).join("/")],r&&(r=r[n])){s=r,a=c;break}if(s)break;!u&&M&&M[n]&&(u=M[n],A=c)}!s&&u&&(s=u,a=A),s&&(i.splice(0,a,s),t=i.join("/"))}return t}function o(t,e){return function(){var i=L.call(arguments,0);return"string"!=typeof i[0]&&1===i.length&&i.push(null),d.apply(n,i.concat([t,e]))}}function a(t){return function(e){return s(e,t)}}function u(t){return function(e){g[t]=e}}function A(t){if(r(p,t)){var e=p[t];delete p[t],v[t]=!0,h.apply(n,e)}if(!r(g,t)&&!r(v,t))throw new Error("No "+t);return g[t]}function c(t){var e,i=t?t.indexOf("!"):-1;return i>-1&&(e=t.substring(0,i),t=t.substring(i+1,t.length)),[e,t]}function l(t){return function(){return m&&m.config&&m.config[t]||{}}}var h,d,f,M,g={},p={},m={},v={},w=Object.prototype.hasOwnProperty,L=[].slice,x=/\.js$/;f=function(t,e){var i,n=c(t),r=n[0];return t=n[1],r&&(r=s(r,e),i=A(r)),r?t=i&&i.normalize?i.normalize(t,a(e)):s(t,e):(t=s(t,e),n=c(t),r=n[0],t=n[1],r&&(i=A(r))),{f:r?r+"!"+t:t,n:t,pr:r,p:i}},M={notrequirebecasebrowserifymessesup:function(t){return o(t)},exports:function(t){var e=g[t];return"undefined"!=typeof e?e:g[t]={}},module:function(t){return{id:t,uri:"",exports:g[t],config:l(t)}}},h=function(t,e,i,s){var a,c,l,h,d,m,w=[],L=typeof i;if(s=s||t,"undefined"===L||"function"===L){for(e=!e.length&&i.length?["notrequirebecasebrowserifymessesup","exports","module"]:e,d=0;d<e.length;d+=1)if(h=f(e[d],s),c=h.f,"notrequirebecasebrowserifymessesup"===c)w[d]=M.notrequirebecasebrowserifymessesup(t);else if("exports"===c)w[d]=M.exports(t),m=!0;else if("module"===c)a=w[d]=M.module(t);else if(r(g,c)||r(p,c)||r(v,c))w[d]=A(c);else{if(!h.p)throw new Error(t+" missing "+c);h.p.load(h.n,o(s,!0),u(c),{}),w[d]=g[c]}l=i?i.apply(g[t],w):void 0,t&&(a&&a.exports!==n&&a.exports!==g[t]?g[t]=a.exports:l===n&&m||(g[t]=l))}else t&&(g[t]=i)},t=e=d=function(t,e,i,r,s){if("string"==typeof t)return M[t]?M[t](e):A(f(t,e).f);if(!t.splice){if(m=t,m.deps&&d(m.deps,m.callback),!e)return;e.splice?(t=e,e=i,i=null):t=n}return e=e||function(){},"function"==typeof i&&(i=r,r=s),r?h(n,t,e,i):setTimeout(function(){h(n,t,e,i)},4),d},d.config=function(t){return d(t)},t._defined=g,i=function(t,e,i){if("string"!=typeof t)throw new Error("See almond README: incorrect module build, no module name");e.splice||(i=e,e=[]),r(g,t)||r(p,t)||(p[t]=[t,e,i])},i.amd={jQuery:!0}}(),i("node_modules/almond/almond.js",function(){}),i("twgl/typedarrays",[],function(){function t(t){if(t instanceof Int8Array)return n;if(t instanceof Uint8Array)return r;if(t instanceof Int16Array)return s;if(t instanceof Uint16Array)return o;if(t instanceof Int32Array)return a;if(t instanceof Uint32Array)return u;if(t instanceof Float32Array)return A;throw"unsupported typed array type"}function e(t){switch(t){case n:return Int8Array;case r:return Uint8Array;case s:return Int16Array;case o:return Uint16Array;case a:return Int32Array;case u:return Uint32Array;case A:return Float32Array;default:throw"unknown gl type"}}function i(t){return t&&t.buffer&&t.buffer instanceof ArrayBuffer}var n=5120,r=5121,s=5122,o=5123,a=5124,u=5125,A=5126;return{getGLTypeForTypedArray:t,getTypedArrayTypeForGLType:e,isArrayBuffer:i}}),i("twgl/attributes",["./typedarrays"],function(t){function e(t){f.attribPrefix=t}function i(t){Object.keys(t).forEach(function(e){f[e]=t[e]})}function n(t,e,i,n,r){t.bindBuffer(e,i),t.bufferData(e,n,r||t.STATIC_DRAW)}function r(t,e,i,r){if(e instanceof WebGLBuffer)return e;i=i||t.ARRAY_BUFFER;var s=t.createBuffer();return n(t,i,s,e,r),s}function s(t){return"indices"===t}function o(t){return t instanceof Int8Array?!0:t instanceof Uint8Array?!0:!1}function a(t,e){var i;if(i=t.indexOf("coord")>=0?2:t.indexOf("color")>=0?4:3,e%i>0)throw"can not guess numComponents. You should specify it.";return i}function u(e,i){if(t.isArrayBuffer(e))return e;if(t.isArrayBuffer(e.data))return e.data;Array.isArray(e)&&(e={data:e});var n=e.type;return n||(n="indices"===i?Uint16Array:Float32Array),new n(e.data)}function A(e,i){var n={};return Object.keys(i).forEach(function(A){if(!s(A)){var c=i[A],l=c.attrib||c.name||c.attribName||f.attribPrefix+A,h=u(c,A);n[l]={buffer:r(e,h,void 0,c.drawType),numComponents:c.numComponents||c.size||a(A),type:t.getGLTypeForTypedArray(h),normalize:void 0!==c.normalize?c.normalize:o(h),stride:c.stride||0,offset:c.offset||0,drawType:c.drawType}}}),n}function c(t,e,i,r){i=u(i),r?(t.bindBuffer(t.ARRAY_BUFFER,e.buffer),t.bufferSubData(t.ARRAY_BUFFER,r,i)):n(t,t.ARRAY_BUFFER,e.buffer,i,e.drawType)}function l(t,e){var i={attribs:A(t,e)},n=e.indices;return n?(n=u(n,"indices"),i.indices=r(t,n,t.ELEMENT_ARRAY_BUFFER),i.numElements=n.length,i.elementType=n instanceof Uint32Array?t.UNSIGNED_INT:t.UNSIGNED_SHORT):i.numElements=M(e),i}function h(t,e,i){var n="indices"===i?t.ELEMENT_ARRAY_BUFFER:t.ARRAY_BUFFER,s=u(e,i);return r(t,s,n)}function d(t,e){var i={};return Object.keys(e).forEach(function(n){i[n]=h(t,e[n],n)}),i}var f={attribPrefix:""},M=function(){var t=["position","positions","a_position"];return function(e){for(var i,n=0;n<t.length&&(i=t[n],!(i in e));++n);n===t.length&&(i=Object.keys(e)[0]);var r=e[i],s=r.length||r.data.length,o=r.numComponents||a(i,s),u=s/o;if(s%o>0)throw"numComponents "+o+" not correct for length "+s;return u}}();return{createAttribsFromArrays:A,createBuffersFromArrays:d,createBufferFromArray:h,createBufferFromTypedArray:r,createBufferInfoFromArrays:l,setAttribInfoBufferFromArray:c,setAttributePrefix:e,setDefaults_:i}}),i("twgl/programs",[],function(){function t(t){return t.split("\n").map(function(t,e){return e+1+": "+t}).join("\n")}function e(e,i,n,r){var s=r||f,o=e.createShader(n);e.shaderSource(o,i),e.compileShader(o);var a=e.getShaderParameter(o,e.COMPILE_STATUS);if(!a){var u=e.getShaderInfoLog(o);return s(t(i)+"\n*** Error compiling shader: "+u),e.deleteShader(o),null}return o}function i(t,e,i,n,r){var s=r||f,o=t.createProgram();e.forEach(function(e){t.attachShader(o,e)}),i&&i.forEach(function(e,i){t.bindAttribLocation(o,n?n[i]:i,e)}),t.linkProgram(o);var a=t.getProgramParameter(o,t.LINK_STATUS);if(!a){var u=t.getProgramInfoLog(o);return s("Error in program linking:"+u),t.deleteProgram(o),null}return o}function n(t,i,n,r){var s,o="",a=document.getElementById(i);if(!a)throw"*** Error: unknown script element"+i;if(o=a.text,!n)if("x-shader/x-vertex"===a.type)s=t.VERTEX_SHADER;else if("x-shader/x-fragment"===a.type)s=t.FRAGMENT_SHADER;else if(s!==t.VERTEX_SHADER&&s!==t.FRAGMENT_SHADER)throw"*** Error: unknown shader type";return e(t,o,n?n:s,r)}function r(t,e,r,s,o){for(var a=[],u=0;u<e.length;++u){var A=n(t,e[u],t[M[u]],o);if(!A)return null;a.push(A)}return i(t,a,r,s,o)}function s(t,n,r,s,o){for(var a=[],u=0;u<n.length;++u){var A=e(t,n[u],t[M[u]],o);if(!A)return null;a.push(A)}return i(t,a,r,s,o)}function o(t,e){return e===t.SAMPLER_2D?t.TEXTURE_2D:e===t.SAMPLER_CUBE?t.TEXTURE_CUBE_MAP:void 0}function a(t,e){function i(e,i){var r=t.getUniformLocation(e,i.name),s=i.type,a=i.size>1&&"[0]"===i.name.substr(-3);if(s===t.FLOAT&&a)return function(e){t.uniform1fv(r,e)};if(s===t.FLOAT)return function(e){t.uniform1f(r,e)};if(s===t.FLOAT_VEC2)return function(e){t.uniform2fv(r,e)};if(s===t.FLOAT_VEC3)return function(e){t.uniform3fv(r,e)};if(s===t.FLOAT_VEC4)return function(e){t.uniform4fv(r,e)};if(s===t.INT&&a)return function(e){t.uniform1iv(r,e)};if(s===t.INT)return function(e){t.uniform1i(r,e)};if(s===t.INT_VEC2)return function(e){t.uniform2iv(r,e)};if(s===t.INT_VEC3)return function(e){t.uniform3iv(r,e)};if(s===t.INT_VEC4)return function(e){t.uniform4iv(r,e)};if(s===t.BOOL&&a)return function(e){t.uniform1iv(r,e)};if(s===t.BOOL)return function(e){t.uniform1i(r,e)};if(s===t.BOOL_VEC2)return function(e){t.uniform2iv(r,e)};if(s===t.BOOL_VEC3)return function(e){t.uniform3iv(r,e)};if(s===t.BOOL_VEC4)return function(e){t.uniform4iv(r,e)};if(s===t.FLOAT_MAT2)return function(e){t.uniformMatrix2fv(r,!1,e)};if(s===t.FLOAT_MAT3)return function(e){t.uniformMatrix3fv(r,!1,e)};if(s===t.FLOAT_MAT4)return function(e){t.uniformMatrix4fv(r,!1,e)};if((s===t.SAMPLER_2D||s===t.SAMPLER_CUBE)&&a){for(var u=[],A=0;A<i.size;++A)u.push(n++);return function(e,i){return function(n){t.uniform1iv(r,i),n.forEach(function(n,r){t.activeTexture(t.TEXTURE0+i[r]),t.bindTexture(e,n)})}}(o(t,s),u)}if(s===t.SAMPLER_2D||s===t.SAMPLER_CUBE)return function(e,i){return function(n){t.uniform1i(r,i),t.activeTexture(t.TEXTURE0+i),t.bindTexture(e,n)}}(o(t,s),n++);throw"unknown type: 0x"+s.toString(16)}for(var n=0,r={},s=t.getProgramParameter(e,t.ACTIVE_UNIFORMS),a=0;s>a;++a){var u=t.getActiveUniform(e,a);if(!u)break;var A=u.name;"[0]"===A.substr(-3)&&(A=A.substr(0,A.length-3));var c=i(e,u);r[A]=c}return r}function u(t,e){for(var i=t.uniformSetters||t,n=arguments.length,r=1;n>r;++r){var s=arguments[r];if(Array.isArray(s))for(var o=s.length,a=0;o>a;++a)u(i,s[a]);else for(var A in s){var c=i[A];c&&c(s[A])}}}function A(t,e){function i(e){return function(i){t.bindBuffer(t.ARRAY_BUFFER,i.buffer),t.enableVertexAttribArray(e),t.vertexAttribPointer(e,i.numComponents||i.size,i.type||t.FLOAT,i.normalize||!1,i.stride||0,i.offset||0)}}for(var n={},r=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES),s=0;r>s;++s){var o=t.getActiveAttrib(e,s);if(!o)break;var a=t.getAttribLocation(e,o.name);n[o.name]=i(a)}return n}function c(t,e){for(var i in e){var n=t[i];n&&n(e[i])}}function l(t,e,i){c(e.attribSetters||e,i.attribs),i.indices&&t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,i.indices)}function h(t,e){var i=a(t,e),n=A(t,e);return{program:e,uniformSetters:i,attribSetters:n}}function d(t,e,i,n,r){e=e.map(function(t){var e=document.getElementById(t);return e?e.text:t});var o=s(t,e,i,n,r);return o?h(t,o):null}var f=window.console&&window.console.error&&"function"==typeof window.console.error?window.console.error.bind(window.console):function(){},M=["VERTEX_SHADER","FRAGMENT_SHADER"];return{createAttributeSetters:A,createProgram:i,createProgramFromScripts:r,createProgramFromSources:s,createProgramInfo:d,createProgramInfoFromProgram:h,createUniformSetters:a,setAttributes:c,setBuffersAndAttributes:l,setUniforms:u}}),i("twgl/draw",["./programs"],function(t){function e(t,e,i,n,r){var s=i.indices,o=void 0===n?i.numElements:n;r=void 0===r?0:r,s?t.drawElements(e,o,void 0===i.elementType?t.UNSIGNED_SHORT:i.elementType,r):t.drawArrays(e,r,o)}function i(i,n){var r=null,s=null;n.forEach(function(n){if(n.active!==!1){var o=n.programInfo,a=n.bufferInfo,u=!1;o!==r&&(r=o,i.useProgram(o.program),u=!0),(u||a!==s)&&(s=a,t.setBuffersAndAttributes(i,o,a)),t.setUniforms(o,n.uniforms),e(i,n.type||i.TRIANGLES,a,n.count,n.offset)}})}return{drawBufferInfo:e,drawObjectList:i}}),i("twgl/utils",[],function(){function t(t){var e={};return Object.keys(t).forEach(function(i){e[i]=t[i]}),e}return{shallowCopy:t}}),i("twgl/textures",["./typedarrays","./utils"],function(t,e){function i(t){I.textureColor=new Uint8Array([255*t[0],255*t[1],255*t[2],255*t[3]])}function n(t){return!R.test(t)}function r(t){t.textureColor&&i(t.textureColor),Object.keys(t).filter(n).forEach(function(e){I[e]=t[e]})}function s(t,e){void 0!==e.colorspaceConversion&&(z.colorSpaceConversion=t.getParameter(t.UNPACK_COLORSPACE_CONVERSION_WEBGL)),void 0!==e.premultiplyAlpha&&(z.premultiplyAlpha=t.getParameter(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL)),void 0!==e.flipY&&(z.flipY=t.getParameter(t.UNPACK_FLIP_Y_WEBGL))}function o(t,e){void 0!==e.colorspaceConversion&&t.pixelStorei(t.UNPACK_COLORSPACE_CONVERSION_WEBGL,z.colorSpaceConversion),void 0!==e.premultiplyAlpha&&t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,z.premultiplyAlpha),void 0!==e.flipY&&t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,z.flipY)}function a(t,e,i){var n=i.target||t.TEXTURE_2D;t.bindTexture(n,e),i.min&&t.texParameteri(n,t.TEXTURE_MIN_FILTER,i.min),i.mag&&t.texParameteri(n,t.TEXTURE_MAG_FILTER,i.mag),i.wrap&&(t.texParameteri(n,t.TEXTURE_WRAP_S,i.wrap),t.texParameteri(n,t.TEXTURE_WRAP_T,i.wrap)),i.wrapS&&t.texParameteri(n,t.TEXTURE_WRAP_S,i.wrapS),i.wrapT&&t.texParameteri(n,t.TEXTURE_WRAP_T,i.wrapT)}function u(t){return t=t||I.textureColor,S(t)?t:new Uint8Array([255*t[0],255*t[1],255*t[2],255*t[3]])}function A(t){return 0===(t&t-1)}function c(t,e,i,n,r){i=i||I.textureOptions;var s=i.target||t.TEXTURE_2D;n=n||i.width,r=r||i.height,t.bindTexture(s,e),A(n)&&A(r)?t.generateMipmap(s):(t.texParameteri(s,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(s,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(s,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE))}function l(t,e){return e=e||{},e.cubeFaceOrder||[t.TEXTURE_CUBE_MAP_POSITIVE_X,t.TEXTURE_CUBE_MAP_NEGATIVE_X,t.TEXTURE_CUBE_MAP_POSITIVE_Y,t.TEXTURE_CUBE_MAP_NEGATIVE_Y,t.TEXTURE_CUBE_MAP_POSITIVE_Z,t.TEXTURE_CUBE_MAP_NEGATIVE_Z]}function h(t,e){var i=l(t,e),n=i.map(function(t,e){return{face:t,ndx:e}});return n.sort(function(t,e){return t.face-e.face}),n}function d(){}function f(t,e,i){i=i||d;var n=new Image;return e=void 0!==e?e:I.crossOrigin,void 0!==e&&(n.crossOrigin=e),n.onerror=function(){var e="couldn't load image: "+t;i(e,n)},n.onload=function(){i(null,n)},n.src=t,n}function M(t,e,i){i=i||I.textureOptions;var n=i.target||t.TEXTURE_2D;if(t.bindTexture(n,e),i.color!==!1){var r=u(i.color);if(n===t.TEXTURE_CUBE_MAP)for(var s=0;6>s;++s)t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+s,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,r);else t.texImage2D(n,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,r)}}function g(t,i,n,r){r=r||d,n=n||I.textureOptions,M(t,i,n),n=e.shallowCopy(n);var s=f(n.src,n.crossOrigin,function(e,s){e?r(e,i,s):(B(t,i,s,n),r(null,i,s))});return s}function p(t,i,n,r){function a(e){return function(a,u){--p,a?m.push(a):u.width!==u.height?m.push("cubemap face img is not a square: "+u.src):(s(t,n),t.bindTexture(h,i),5===p?l(t).forEach(function(e){t.texImage2D(e,0,A,A,c,u)}):t.texImage2D(e,0,A,A,c,u),o(t,n),t.generateMipmap(h)),0===p&&r(m.length?m:void 0,g,i)}}r=r||d;var u=n.src;if(6!==u.length)throw"there must be 6 urls for a cubemap";var A=n.format||t.RGBA,c=n.type||t.UNSIGNED_BYTE,h=n.target||t.TEXTURE_2D;if(h!==t.TEXTURE_CUBE_MAP)throw"target must be TEXTURE_CUBE_MAP";M(t,i,n),n=e.shallowCopy(n);var g,p=6,m=[],v=l(t,n);g=u.map(function(t,e){return f(t,n.crossOrigin,a(v[e]))})}function m(t){switch(t){case E:case j:return 1;case N:return 2;case C:return 3;case b:return 4;default:throw"unknown type: "+t}}function v(e,i){return S(i)?t.getGLTypeForTypedArray(i):e.UNSIGNED_BYTE}function w(e,i,n,r){r=r||I.textureOptions;var a=r.target||e.TEXTURE_2D;e.bindTexture(a,i);var u=r.width,A=r.height,c=r.format||e.RGBA,l=r.type||v(e,n),d=m(c),f=n.length/d;if(f%1)throw"length wrong size for format: "+k(e,c);if(u||A){if(A){if(!u&&(u=f/A,u%1))throw"can't guess width"}else if(A=f/u,A%1)throw"can't guess height"}else{var M=Math.sqrt(f/(a===e.TEXTURE_CUBE_MAP?6:1));M%1===0?(u=M,A=M):(u=f,A=1)}if(!S(n)){var g=t.getTypedArrayTypeForGLType(l);n=new g(n)}if(e.pixelStorei(e.UNPACK_ALIGNMENT,r.unpackAlignment||1),s(e,r),a===e.TEXTURE_CUBE_MAP){var p=f/6*d;h(e,r).forEach(function(t){var i=p*t.ndx,r=n.subarray(i,i+p);e.texImage2D(t.face,0,c,u,A,0,c,l,r)})}else e.texImage2D(a,0,c,u,A,0,c,l,n);return o(e,r),{width:u,height:A}}function L(t,e,i){var n=i.target||t.TEXTURE_2D;t.bindTexture(n,e);var r=i.format||t.RGBA,o=i.type||t.UNSIGNED_BYTE;if(s(t,i),n===t.TEXTURE_CUBE_MAP)for(var a=0;6>a;++a)t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+a,0,r,i.width,i.height,0,r,o,null);else t.texImage2D(n,0,r,i.width,i.height,0,r,o,null)}function x(t,e,i){i=i||d,e=e||I.textureOptions;var n=t.createTexture(),r=e.target||t.TEXTURE_2D,s=e.width||1,o=e.height||1;t.bindTexture(r,n),r===t.TEXTURE_CUBE_MAP&&(t.texParameteri(r,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(r,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE));var u=e.src;if(u)if("function"==typeof u&&(u=u(t,e)),"string"==typeof u)g(t,n,e,i);else if(S(u)||Array.isArray(u)&&("number"==typeof u[0]||Array.isArray(u[0])||S(u[0]))){var A=w(t,n,u,e);s=A.width,o=A.height}else if(Array.isArray(u)&&"string"==typeof u[0])p(t,n,e,i);else{if(!(u instanceof HTMLElement))throw"unsupported src type";B(t,n,u,e),s=u.width,o=u.height}else L(t,n,e);return e.auto!==!1&&c(t,n,e,s,o),a(t,n,e),n}function D(t,e,i,n,r){n=n||i.width,r=r||i.height;var s=i.target||t.TEXTURE_2D;t.bindTexture(s,e);var o,a=i.format||t.RGBA,u=i.src;if(o=u&&(S(u)||Array.isArray(u)&&"number"==typeof u[0])?i.type||v(t,u):i.type||t.UNSIGNED_BYTE,s===t.TEXTURE_CUBE_MAP)for(var A=0;6>A;++A)t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+A,0,a,n,r,0,a,o,null);else t.texImage2D(s,0,a,n,r,0,a,o,null)}function T(t){return"string"==typeof t||Array.isArray(t)&&"string"==typeof t[0]}function y(t,e,i){function n(){0===r&&setTimeout(function(){i(s.length?s:void 0,o,a)},0)}i=i||d;var r=0,s=[],o={},a={};return Object.keys(e).forEach(function(i){var u=e[i],A=void 0;T(u.src)&&(A=function(t,e,o){a[i]=o,--r,t&&s.push(t),n()},++r),o[i]=x(t,u,A)}),n(),o}var I={textureColor:new Uint8Array([128,192,255,255]),textureOptions:{}},S=t.isArrayBuffer,E=6406,C=6407,b=6408,j=6409,N=6410,R=/^textureColor$/,k=function(){function t(t){e||(e={},Object.keys(t).forEach(function(i){"number"==typeof t[i]&&(e[t[i]]=i)}))}var e;return function(i,n){return t(),e[n]||"0x"+n.toString(16)}}(),z={},B=function(){var t=document.createElement("canvas").getContext("2d");return function(e,i,n,r){r=r||I.textureOptions;var u=r.target||e.TEXTURE_2D,A=n.width,l=n.height,d=r.format||e.RGBA,f=r.type||e.UNSIGNED_BYTE;if(s(e,r),e.bindTexture(u,i),u===e.TEXTURE_CUBE_MAP){var M,g,p=n.width,m=n.height;if(p/6===m)M=m,g=[0,0,1,0,2,0,3,0,4,0,5,0];else if(m/6===p)M=p,g=[0,0,0,1,0,2,0,3,0,4,0,5];else if(p/3===m/2)M=p/3,g=[0,0,1,0,2,0,0,1,1,1,2,1];else{if(p/2!==m/3)throw"can't figure out cube map from element: "+(n.src?n.src:n.nodeName);M=p/2,g=[0,0,1,0,0,1,1,1,0,2,1,2]}t.canvas.width=M,t.canvas.height=M,A=M,l=M,h(e,r).forEach(function(i){var r=g[2*i.ndx+0]*M,s=g[2*i.ndx+1]*M;t.drawImage(n,r,s,M,M,0,0,M,M),e.texImage2D(i.face,0,d,d,f,t.canvas)}),t.canvas.width=1,t.canvas.height=1}else e.texImage2D(u,0,d,d,f,n);o(e,r),r.auto!==!1&&c(e,i,r,A,l),a(e,i,r)}}();return{setDefaults_:r,createTexture:x,setEmptyTexture:L,setTextureFromArray:w,loadTextureFromUrl:g,setTextureFromElement:B,setTextureFilteringForSize:c,setTextureParameters:a,setDefaultTextureColor:i,createTextures:y,resizeTexture:D,getNumComponentsForFormat:m}}),i("twgl/framebuffers",["./textures","./utils"],function(t,e){function i(t){return T[t]}function n(t){return y[t]}function r(r,s,o,a){var u=r.FRAMEBUFFER,A=r.createFramebuffer();r.bindFramebuffer(u,A),o=o||r.drawingBufferWidth,a=a||r.drawingBufferHeight,s=s||D;var c=0,l={framebuffer:A,attachments:[],width:o,height:a};return s.forEach(function(s){var A=s.attachment,h=s.format,d=i(h);if(d||(d=p+c++),!A)if(n(h))A=r.createRenderbuffer(),r.bindRenderbuffer(r.RENDERBUFFER,A),r.renderbufferStorage(r.RENDERBUFFER,h,o,a);else{var f=e.shallowCopy(s);f.width=o,f.height=a,f.auto=void 0===s.auto?!1:s.auto,A=t.createTexture(r,f)}if(A instanceof WebGLRenderbuffer)r.framebufferRenderbuffer(u,d,r.RENDERBUFFER,A);else{if(!(A instanceof WebGLTexture))throw"unknown attachment type";r.framebufferTexture2D(u,d,s.texTarget||r.TEXTURE_2D,A,s.level||0)}l.attachments.push(A)}),l}function s(e,i,n,r,s){r=r||e.drawingBufferWidth,s=s||e.drawingBufferHeight,i.width=r,i.height=s,n=n||D,n.forEach(function(n,o){var a=i.attachments[o],u=n.format;if(a instanceof WebGLRenderbuffer)e.bindRenderbuffer(e.RENDERBUFFER,a),e.renderbufferStorage(e.RENDERBUFFER,u,r,s);else{if(!(a instanceof WebGLTexture))throw"unknown attachment type";t.resizeTexture(e,a,n,r,s)}})}function o(t,e,i){i=i||t.FRAMEBUFFER,e?(t.bindFramebuffer(i,e.framebuffer),t.viewport(0,0,e.width,e.height)):(t.bindFramebuffer(i,null),t.viewport(0,0,t.drawingBufferWidth,t.drawingBufferHeight))}var a=5121,u=6402,A=6408,c=32854,l=32855,h=36194,d=33189,f=6401,M=36168,g=34041,p=36064,m=36096,v=36128,w=33306,L=33071,x=9729,D=[{format:A,type:a,min:x,wrap:L},{format:g}],T={};T[g]=w,T[f]=v,T[M]=v,T[u]=m,T[d]=m;var y={};return y[c]=!0,y[l]=!0,y[h]=!0,y[g]=!0,y[d]=!0,y[f]=!0,y[M]=!0,{bindFramebufferInfo:o,createFramebufferInfo:r,resizeFramebufferInfo:s}}),i("twgl/twgl",["./attributes","./draw","./framebuffers","./programs","./textures","./typedarrays"],function(t,e,i,n,r,s){function o(e){t.setDefaults_(e),r.setDefaults_(e)}function a(t,e){for(var i=["webgl","experimental-webgl"],n=null,r=0;r<i.length;++r){try{n=t.getContext(i[r],e)}catch(s){}if(n)break}return n}function u(t,e){var i=a(t,e);return i}function A(t,e){e=e||1,e=Math.max(1,e);var i=t.clientWidth*e|0,n=t.clientHeight*e|0;return t.width!==i||t.height!==n?(t.width=i,t.height=n,!0):!1}function c(t){return"_"!==t[t.length-1]}function l(t,e){Object.keys(t).filter(c).forEach(function(i){e[i]=t[i]})}var h={getWebGLContext:u,resizeCanvasToDisplaySize:A,setDefaults:o};return[t,e,i,n,r,s].forEach(function(t){l(t,h)}),h}),i("twgl/v3",[],function(){function t(t){g=t}function e(t,e,i){var n=new g(3);return t&&(n[0]=t),e&&(n[1]=e),i&&(n[2]=i),n}function i(t,e,i){return i=i||new g(3),i[0]=t[0]+e[0],i[1]=t[1]+e[1],i[2]=t[2]+e[2],i}function n(t,e,i){return i=i||new g(3),i[0]=t[0]-e[0],i[1]=t[1]-e[1],i[2]=t[2]-e[2],i}function r(t,e,i,n){return n=n||new g(3),n[0]=(1-i)*t[0]+i*e[0],n[1]=(1-i)*t[1]+i*e[1],n[2]=(1-i)*t[2]+i*e[2],n}function s(t,e,i){return i=i||new g(3),i[0]=t[0]*e,i[1]=t[1]*e,i[2]=t[2]*e,i}function o(t,e,i){return i=i||new g(3),i[0]=t[0]/e,i[1]=t[1]/e,i[2]=t[2]/e,i}function a(t,e,i){return i=i||new g(3),i[0]=t[1]*e[2]-t[2]*e[1],i[1]=t[2]*e[0]-t[0]*e[2],i[2]=t[0]*e[1]-t[1]*e[0],i}function u(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function A(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2])}function c(t){return t[0]*t[0]+t[1]*t[1]+t[2]*t[2]}function l(t,e){e=e||new g(3);var i=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],n=Math.sqrt(i);return n>1e-5?(e[0]=t[0]/n,e[1]=t[1]/n,e[2]=t[2]/n):(e[0]=0,e[1]=0,e[2]=0),e}function h(t,e){return e=e||new g(3),e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e}function d(t,e){return e=e||new g(3),e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function f(t,e,i){return i=i||new g(3),i[0]=t[0]*e[0],i[1]=t[1]*e[1],i[2]=t[2]*e[2],i}function M(t,e,i){return i=i||new g(3),i[0]=t[0]/e[0],i[1]=t[1]/e[1],i[2]=t[2]/e[2],i}var g=Float32Array;return{add:i,copy:d,create:e,cross:a,divide:M,divScalar:o,dot:u,lerp:r,length:A,lengthSq:c,mulScalar:s,multiply:f,negate:h,normalize:l,setDefaultType:t,subtract:n}}),i("twgl/m4",["./v3"],function(t){function e(t){VecType=t}function i(t,e){return e=e||new b(16),e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=-t[3],e[4]=-t[4],e[5]=-t[5],e[6]=-t[6],e[7]=-t[7],e[8]=-t[8],e[9]=-t[9],e[10]=-t[10],e[11]=-t[11],e[12]=-t[12],e[13]=-t[13],e[14]=-t[14],e[15]=-t[15],e}function n(t,e){return e=e||new b(16),e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function r(t){return t=t||new b(16),t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function s(t,e){if(e=e||new b(16),e===t){var i;return i=t[1],t[1]=t[4],t[4]=i,i=t[2],t[2]=t[8],t[8]=i,i=t[3],t[3]=t[12],t[12]=i,i=t[6],t[6]=t[9],t[9]=i,i=t[7],t[7]=t[13],t[13]=i,i=t[11],t[11]=t[14],t[14]=i,e}var n=t[0],r=t[1],s=t[2],o=t[3],a=t[4],u=t[5],A=t[6],c=t[7],l=t[8],h=t[9],d=t[10],f=t[11],M=t[12],g=t[13],p=t[14],m=t[15];return e[0]=n,e[1]=a,e[2]=l,e[3]=M,e[4]=r,e[5]=u,e[6]=h,e[7]=g,e[8]=s,e[9]=A,e[10]=d,e[11]=p,e[12]=o,e[13]=c,e[14]=f,e[15]=m,e}function o(t,e){e=e||new b(16);var i=t[0],n=t[1],r=t[2],s=t[3],o=t[4],a=t[5],u=t[6],A=t[7],c=t[8],l=t[9],h=t[10],d=t[11],f=t[12],M=t[13],g=t[14],p=t[15],m=h*p,v=g*d,w=u*p,L=g*A,x=u*d,D=h*A,T=r*p,y=g*s,I=r*d,S=h*s,E=r*A,C=u*s,j=c*M,N=f*l,R=o*M,k=f*a,z=o*l,B=c*a,P=i*M,O=f*n,U=i*l,V=c*n,Q=i*a,F=o*n,G=m*a+L*l+x*M-(v*a+w*l+D*M),Z=v*n+T*l+S*M-(m*n+y*l+I*M),_=w*n+y*a+E*M-(L*n+T*a+C*M),W=D*n+I*a+C*l-(x*n+S*a+E*l),H=1/(i*G+o*Z+c*_+f*W);return e[0]=H*G,e[1]=H*Z,e[2]=H*_,e[3]=H*W,e[4]=H*(v*o+w*c+D*f-(m*o+L*c+x*f)),e[5]=H*(m*i+y*c+I*f-(v*i+T*c+S*f)),e[6]=H*(L*i+T*o+C*f-(w*i+y*o+E*f)),e[7]=H*(x*i+S*o+E*c-(D*i+I*o+C*c)),e[8]=H*(j*A+k*d+z*p-(N*A+R*d+B*p)),e[9]=H*(N*s+P*d+V*p-(j*s+O*d+U*p)),e[10]=H*(R*s+O*A+Q*p-(k*s+P*A+F*p)),e[11]=H*(B*s+U*A+F*d-(z*s+V*A+Q*d)),e[12]=H*(R*h+B*g+N*u-(z*g+j*u+k*h)),e[13]=H*(U*g+j*r+O*h-(P*h+V*g+N*r)),e[14]=H*(P*u+F*g+k*r-(Q*g+R*r+O*u)),e[15]=H*(Q*h+z*r+V*u-(U*u+F*h+B*r)),e}function a(t,e,i){i=i||new b(16);var n=t[0],r=t[1],s=t[2],o=t[3],a=t[4],u=t[5],A=t[6],c=t[7],l=t[8],h=t[9],d=t[10],f=t[11],M=t[12],g=t[13],p=t[14],m=t[15],v=e[0],w=e[1],L=e[2],x=e[3],D=e[4],T=e[5],y=e[6],I=e[7],S=e[8],E=e[9],C=e[10],j=e[11],N=e[12],R=e[13],k=e[14],z=e[15];return i[0]=n*v+r*D+s*S+o*N,i[1]=n*w+r*T+s*E+o*R,i[2]=n*L+r*y+s*C+o*k,i[3]=n*x+r*I+s*j+o*z,i[4]=a*v+u*D+A*S+c*N,i[5]=a*w+u*T+A*E+c*R,i[6]=a*L+u*y+A*C+c*k,i[7]=a*x+u*I+A*j+c*z,i[8]=l*v+h*D+d*S+f*N,i[9]=l*w+h*T+d*E+f*R,i[10]=l*L+h*y+d*C+f*k,i[11]=l*x+h*I+d*j+f*z,i[12]=M*v+g*D+p*S+m*N,i[13]=M*w+g*T+p*E+m*R,i[14]=M*L+g*y+p*C+m*k,i[15]=M*x+g*I+p*j+m*z,i}function u(t,e,i){return i=i||r(),t!==i&&(i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=t[3],i[4]=t[4],i[5]=t[5],i[6]=t[6],i[7]=t[7],i[8]=t[8],i[9]=t[9],i[10]=t[10],i[11]=t[11]),i[12]=e[0],i[13]=e[1],i[14]=e[2],i[15]=1,i}function A(e,i){return i=i||t.create(),i[0]=e[12],i[1]=e[13],i[2]=e[14],i}function c(e,i,n){n=n||t.create();var r=4*i;return n[0]=e[r+0],n[1]=e[r+1],n[2]=e[r+2],n}function l(t,e,i,n,r){r=r||new b(16);var s=Math.tan(.5*Math.PI-.5*t),o=1/(i-n);return r[0]=s/e,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=s,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=(i+n)*o,r[11]=-1,r[12]=0,r[13]=0,r[14]=i*n*o*2,r[15]=0,r}function h(t,e,i,n,r,s,o){return o=o||new b(16),o[0]=2/(e-t),o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=2/(n-i),o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=-1/(s-r),o[11]=0,o[12]=(e+t)/(t-e),o[13]=(n+i)/(i-n),o[14]=-r/(r-s),o[15]=1,o}function d(t,e,i,n,r,s,o){o=o||new b(16);var a=e-t,u=n-i,A=r-s;return o[0]=2*r/a,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=2*r/u,o[6]=0,o[7]=0,o[8]=(t+e)/a,o[9]=(n+i)/u,o[10]=s/A,o[11]=-1,o[12]=0,o[13]=0,o[14]=r*s/A,o[15]=0,o}function f(e,i,n,r){r=r||new b(16);var s=j,o=N,a=R;return t.normalize(t.subtract(e,i,a),a),t.normalize(t.cross(n,a,s),s),t.normalize(t.cross(a,s,o),o),r[0]=s[0],r[1]=s[1],r[2]=s[2],r[3]=0,r[4]=o[0],r[5]=o[1],r[6]=o[2],r[7]=0,r[8]=a[0],r[9]=a[1],r[10]=a[2],r[11]=0,r[12]=e[0],r[13]=e[1],r[14]=e[2],r[15]=1,r}function M(t,e){return e=e||new b(16),e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e}function g(t,e,i){i=i||new b(16);var n=e[0],r=e[1],s=e[2],o=t[0],a=t[1],u=t[2],A=t[3],c=t[4],l=t[5],h=t[6],d=t[7],f=t[8],M=t[9],g=t[10],p=t[11],m=t[12],v=t[13],w=t[14],L=t[15];return t!==i&&(i[0]=o,i[1]=a,i[2]=u,i[3]=A,i[4]=c,i[5]=l,i[6]=h,i[7]=d,i[8]=f,i[9]=M,i[10]=g,i[11]=p),i[12]=o*n+c*r+f*s+m,i[13]=a*n+l*r+M*s+v,i[14]=u*n+h*r+g*s+w,i[15]=A*n+d*r+p*s+L,i}function p(t,e){e=e||new b(16);var i=Math.cos(t),n=Math.sin(t);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=i,e[6]=n,e[7]=0,e[8]=0,e[9]=-n,e[10]=i,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function m(t,e,i){i=i||new b(16);var n=t[4],r=t[5],s=t[6],o=t[7],a=t[8],u=t[9],A=t[10],c=t[11],l=Math.cos(e),h=Math.sin(e);return i[4]=l*n+h*a,i[5]=l*r+h*u,i[6]=l*s+h*A,i[7]=l*o+h*c,i[8]=l*a-h*n,i[9]=l*u-h*r,i[10]=l*A-h*s,i[11]=l*c-h*o,t!==i&&(i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=t[3],i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15]),i}function v(t,e){e=e||new b(16);var i=Math.cos(t),n=Math.sin(t);return e[0]=i,e[1]=0,e[2]=-n,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=n,e[9]=0,e[10]=i,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function w(t,e,i){i=i||new b(16);var n=t[0],r=t[1],s=t[2],o=t[3],a=t[8],u=t[9],A=t[10],c=t[11],l=Math.cos(e),h=Math.sin(e);return i[0]=l*n-h*a,i[1]=l*r-h*u,i[2]=l*s-h*A,i[3]=l*o-h*c,i[8]=l*a+h*n,i[9]=l*u+h*r,i[10]=l*A+h*s,i[11]=l*c+h*o,t!==i&&(i[4]=t[4],i[5]=t[5],i[6]=t[6],i[7]=t[7],i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15]),i}function L(t,e){e=e||new b(16);var i=Math.cos(t),n=Math.sin(t);return e[0]=i,e[1]=n,e[2]=0,e[3]=0,e[4]=-n,e[5]=i,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function x(t,e,i){i=i||new b(16);var n=t[0],r=t[1],s=t[2],o=t[3],a=t[4],u=t[5],A=t[6],c=t[7],l=Math.cos(e),h=Math.sin(e);return i[0]=l*n+h*a,i[1]=l*r+h*u,i[2]=l*s+h*A,i[3]=l*o+h*c,i[4]=l*a-h*n,i[5]=l*u-h*r,i[6]=l*A-h*s,i[7]=l*c-h*o,t!==i&&(i[8]=t[8],i[9]=t[9],i[10]=t[10],i[11]=t[11],i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15]),i}function D(t,e,i){i=i||new b(16);var n=t[0],r=t[1],s=t[2],o=Math.sqrt(n*n+r*r+s*s);n/=o,r/=o,s/=o;var a=n*n,u=r*r,A=s*s,c=Math.cos(e),l=Math.sin(e),h=1-c;return i[0]=a+(1-a)*c,i[1]=n*r*h+s*l,i[2]=n*s*h-r*l,i[3]=0,i[4]=n*r*h-s*l,i[5]=u+(1-u)*c,i[6]=r*s*h+n*l,i[7]=0,i[8]=n*s*h+r*l,i[9]=r*s*h-n*l,i[10]=A+(1-A)*c,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i}function T(t,e,i,n){n=n||new b(16);var r=e[0],s=e[1],o=e[2],a=Math.sqrt(r*r+s*s+o*o);r/=a,s/=a,o/=a;var u=r*r,A=s*s,c=o*o,l=Math.cos(i),h=Math.sin(i),d=1-l,f=u+(1-u)*l,M=r*s*d+o*h,g=r*o*d-s*h,p=r*s*d-o*h,m=A+(1-A)*l,v=s*o*d+r*h,w=r*o*d+s*h,L=s*o*d-r*h,x=c+(1-c)*l,D=t[0],T=t[1],y=t[2],I=t[3],S=t[4],E=t[5],C=t[6],j=t[7],N=t[8],R=t[9],k=t[10],z=t[11];return n[0]=f*D+M*S+g*N,n[1]=f*T+M*E+g*R,n[2]=f*y+M*C+g*k,n[3]=f*I+M*j+g*z,n[4]=p*D+m*S+v*N,n[5]=p*T+m*E+v*R,n[6]=p*y+m*C+v*k,n[7]=p*I+m*j+v*z,n[8]=w*D+L*S+x*N,n[9]=w*T+L*E+x*R,n[10]=w*y+L*C+x*k,n[11]=w*I+L*j+x*z,t!==n&&(n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15]),n}function y(t,e){return e=e||new b(16),e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],
e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function I(t,e,i){i=i||new b(16);var n=e[0],r=e[1],s=e[2];return i[0]=n*t[0],i[1]=n*t[1],i[2]=n*t[2],i[3]=n*t[3],i[4]=r*t[4],i[5]=r*t[5],i[6]=r*t[6],i[7]=r*t[7],i[8]=s*t[8],i[9]=s*t[9],i[10]=s*t[10],i[11]=s*t[11],t!==i&&(i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15]),i}function S(e,i,n){n=n||t.create();var r=i[0],s=i[1],o=i[2],a=r*e[3]+s*e[7]+o*e[11]+e[15];return n[0]=(r*e[0]+s*e[4]+o*e[8]+e[12])/a,n[1]=(r*e[1]+s*e[5]+o*e[9]+e[13])/a,n[2]=(r*e[2]+s*e[6]+o*e[10]+e[14])/a,n}function E(e,i,n){n=n||t.create();var r=i[0],s=i[1],o=i[2];return n[0]=r*e[0]+s*e[4]+o*e[8],n[1]=r*e[1]+s*e[5]+o*e[9],n[2]=r*e[2]+s*e[6]+o*e[10],n}function C(e,i,n){n=n||t.create();var r=o(e),s=i[0],a=i[1],u=i[2];return n[0]=s*r[0]+a*r[1]+u*r[2],n[1]=s*r[4]+a*r[5]+u*r[6],n[2]=s*r[8]+a*r[9]+u*r[10],n}var b=Float32Array,j=t.create(),N=t.create(),R=t.create();return{axisRotate:T,axisRotation:D,create:r,copy:n,frustum:d,getAxis:c,getTranslation:A,identity:r,inverse:o,lookAt:f,multiply:a,negate:i,ortho:h,perspective:l,rotateX:m,rotateY:w,rotateZ:x,rotateAxis:T,rotationX:p,rotationY:v,rotationZ:L,scale:I,scaling:y,setDefaultType:e,setTranslation:u,transformDirection:E,transformNormal:C,transformPoint:S,translate:g,translation:M,transpose:s}}),i("twgl/primitives",["./twgl","./m4","./v3"],function(t,e,i){function n(t,e){var i=0;return t.push=function(){for(var e=0;e<arguments.length;++e){var n=arguments[e];if(n instanceof Array||n.buffer&&n.buffer instanceof ArrayBuffer)for(var r=0;r<n.length;++r)t[i++]=n[r];else t[i++]=n}},t.reset=function(t){i=t||0},t.numComponents=e,Object.defineProperty(t,"numElements",{get:function(){return this.length/this.numComponents|0}}),t}function r(t,e,i){var r=i||Float32Array;return n(new r(t*e),t)}function s(t){return"indices"!==t}function o(t){function e(e){for(var s=t[e],a=s.numComponents,u=r(a,o,s.constructor),A=0;o>A;++A)for(var c=i[A],l=c*a,h=0;a>h;++h)u.push(s[l+h]);n[e]=u}var i=t.indices,n={},o=i.length;return Object.keys(t).filter(s).forEach(e),n}function a(t){if(t.indices)throw"can't flatten normals of indexed vertices. deindex them first";for(var e=t.normal,i=e.length,n=0;i>n;n+=9){var r=e[n+0],s=e[n+1],o=e[n+2],a=e[n+3],u=e[n+4],A=e[n+5],c=e[n+6],l=e[n+7],h=e[n+8],d=r+a+c,f=s+u+l,M=o+A+h,g=Math.sqrt(d*d+f*f+M*M);d/=g,f/=g,M/=g,e[n+0]=d,e[n+1]=f,e[n+2]=M,e[n+3]=d,e[n+4]=f,e[n+5]=M,e[n+6]=d,e[n+7]=f,e[n+8]=M}return t}function u(t,e,i){for(var n=t.length,r=new Float32Array(3),s=0;n>s;s+=3)i(e,[t[s],t[s+1],t[s+2]],r),t[s]=r[0],t[s+1]=r[1],t[s+2]=r[2]}function A(t,e,n){n=n||i.create();var r=e[0],s=e[1],o=e[2];return n[0]=r*t[0]+s*t[1]+o*t[2],n[1]=r*t[4]+s*t[5]+o*t[6],n[2]=r*t[8]+s*t[9]+o*t[10],n}function c(t,i){return u(t,i,e.transformDirection),t}function l(t,i){return u(t,e.inverse(i),A),t}function h(t,i){return u(t,i,e.transformPoint),t}function d(t,e){return Object.keys(t).forEach(function(i){var n=t[i];i.indexOf("pos")>=0?h(n,e):i.indexOf("tan")>=0||i.indexOf("binorm")>=0?c(n,e):i.indexOf("norm")>=0&&l(n,e)}),t}function f(t,e,i){return t=t||2,e=e||0,i=i||0,t*=.5,{position:{numComponents:2,data:[e+-1*t,i+-1*t,e+1*t,i+-1*t,e+-1*t,i+1*t,e+1*t,i+1*t]},normal:[0,0,1,0,0,1,0,0,1,0,0,1],texcoord:[0,0,1,0,0,1,1,1],indices:[0,1,2,2,1,3]}}function M(t,i,n,s,o){t=t||1,i=i||1,n=n||1,s=s||1,o=o||e.identity();for(var a=(n+1)*(s+1),u=r(3,a),A=r(3,a),c=r(2,a),l=0;s>=l;l++)for(var h=0;n>=h;h++){var f=h/n,M=l/s;u.push(t*f-.5*t,0,i*M-.5*i),A.push(0,1,0),c.push(f,M)}for(var g=n+1,p=r(3,n*s*2,Uint16Array),l=0;s>l;l++)for(var h=0;n>h;h++)p.push((l+0)*g+h,(l+1)*g+h,(l+0)*g+h+1),p.push((l+1)*g+h,(l+1)*g+h+1,(l+0)*g+h+1);var m=d({position:u,normal:A,texcoord:c,indices:p},o);return m}function g(t,e,i,n,s,o,a){if(0>=e||0>=i)throw Error("subdivisionAxis and subdivisionHeight must be > 0");n=n||0,s=s||Math.PI,o=o||0,a=a||2*Math.PI;for(var u=s-n,A=a-o,c=(e+1)*(i+1),l=r(3,c),h=r(3,c),d=r(2,c),f=0;i>=f;f++)for(var M=0;e>=M;M++){var g=M/e,p=f/i,m=A*g,v=u*p,w=Math.sin(m),L=Math.cos(m),x=Math.sin(v),D=Math.cos(v),T=L*x,y=D,I=w*x;l.push(t*T,t*y,t*I),h.push(T,y,I),d.push(1-g,p)}for(var S=e+1,E=r(3,e*i*2,Uint16Array),M=0;e>M;M++)for(var f=0;i>f;f++)E.push((f+0)*S+M,(f+0)*S+M+1,(f+1)*S+M),E.push((f+1)*S+M,(f+0)*S+M+1,(f+1)*S+M+1);return{position:l,normal:h,texcoord:d,indices:E}}function p(t){t=t||1;for(var e=t/2,i=[[-e,-e,-e],[+e,-e,-e],[-e,+e,-e],[+e,+e,-e],[-e,-e,+e],[+e,-e,+e],[-e,+e,+e],[+e,+e,+e]],n=[[1,0,0],[-1,0,0],[0,1,0],[0,-1,0],[0,0,1],[0,0,-1]],s=[[1,0],[0,0],[0,1],[1,1]],o=24,a=r(3,o),u=r(3,o),A=r(2,o),c=r(3,12,Uint16Array),l=0;6>l;++l){for(var h=C[l],d=0;4>d;++d){var f=i[h[d]],M=n[l],g=s[d];a.push(f),u.push(M),A.push(g)}var p=4*l;c.push(p+0,p+1,p+2),c.push(p+0,p+2,p+3)}return{position:a,normal:u,texcoord:A,indices:c}}function m(t,e,i,n,s,o,a){if(3>n)throw Error("radialSubdivisions must be 3 or greater");if(1>s)throw Error("verticalSubdivisions must be 1 or greater");for(var u=void 0===o?!0:o,A=void 0===a?!0:a,c=(u?2:0)+(A?2:0),l=(n+1)*(s+1+c),h=r(3,l),d=r(3,l),f=r(2,l),M=r(3,n*(s+c)*2,Uint16Array),g=n+1,p=Math.atan2(t-e,i),m=Math.cos(p),v=Math.sin(p),w=u?-2:0,L=s+(A?2:0),x=w;L>=x;++x){var D,T=x/s,y=i*T;0>x?(y=0,T=1,D=t):x>s?(y=i,T=1,D=e):D=t+(e-t)*(x/s),(-2===x||x===s+2)&&(D=0,T=0),y-=i/2;for(var I=0;g>I;++I){var S=Math.sin(I*Math.PI*2/n),E=Math.cos(I*Math.PI*2/n);h.push(S*D,y,E*D),d.push(0>x||x>s?0:S*m,0>x?-1:x>s?1:v,0>x||x>s?0:E*m),f.push(I/n,1-T)}}for(var x=0;s+c>x;++x)for(var I=0;n>I;++I)M.push(g*(x+0)+0+I,g*(x+0)+1+I,g*(x+1)+1+I),M.push(g*(x+0)+0+I,g*(x+1)+1+I,g*(x+1)+0+I);return{position:h,normal:d,texcoord:f,indices:M}}function v(t,e){e=e||[];for(var i=[],n=0;n<t.length;n+=4){var r=t[n],s=t.slice(n+1,n+4);s.push.apply(s,e);for(var o=0;r>o;++o)i.push.apply(i,s)}return i}function w(){var t=[0,0,0,0,150,0,30,0,0,0,150,0,30,150,0,30,0,0,30,0,0,30,30,0,100,0,0,30,30,0,100,30,0,100,0,0,30,60,0,30,90,0,67,60,0,30,90,0,67,90,0,67,60,0,0,0,30,30,0,30,0,150,30,0,150,30,30,0,30,30,150,30,30,0,30,100,0,30,30,30,30,30,30,30,100,0,30,100,30,30,30,60,30,67,60,30,30,90,30,30,90,30,67,60,30,67,90,30,0,0,0,100,0,0,100,0,30,0,0,0,100,0,30,0,0,30,100,0,0,100,30,0,100,30,30,100,0,0,100,30,30,100,0,30,30,30,0,30,30,30,100,30,30,30,30,0,100,30,30,100,30,0,30,30,0,30,60,30,30,30,30,30,30,0,30,60,0,30,60,30,30,60,0,67,60,30,30,60,30,30,60,0,67,60,0,67,60,30,67,60,0,67,90,30,67,60,30,67,60,0,67,90,0,67,90,30,30,90,0,30,90,30,67,90,30,30,90,0,67,90,30,67,90,0,30,90,0,30,150,30,30,90,30,30,90,0,30,150,0,30,150,30,0,150,0,0,150,30,30,150,30,0,150,0,30,150,30,30,150,0,0,0,0,0,0,30,0,150,30,0,0,0,0,150,30,0,150,0],e=[.22,.19,.22,.79,.34,.19,.22,.79,.34,.79,.34,.19,.34,.19,.34,.31,.62,.19,.34,.31,.62,.31,.62,.19,.34,.43,.34,.55,.49,.43,.34,.55,.49,.55,.49,.43,0,0,1,0,0,1,0,1,1,0,1,1,0,0,1,0,0,1,0,1,1,0,1,1,0,0,1,0,0,1,0,1,1,0,1,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,0,1,1,1,0,0,1,1,1,0,0,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,0,0,1,1,1,0,0,1,1,1,0,0,0,1,1,0,1,0,0,1,0,1,1,0,0,0,1,1,1,0,0,1,1,1,0,0,0,0,1,1,1,0,0,1,1,1,0],i=v([18,0,0,1,18,0,0,-1,6,0,1,0,6,1,0,0,6,0,-1,0,6,1,0,0,6,0,1,0,6,1,0,0,6,0,-1,0,6,1,0,0,6,0,-1,0,6,-1,0,0]),n=v([18,200,70,120,18,80,70,200,6,70,200,210,6,200,200,70,6,210,100,70,6,210,160,70,6,70,180,210,6,100,70,210,6,76,210,100,6,140,210,80,6,90,130,110,6,160,160,220],[255]),s=t.length/3,o={position:r(3,s),texcoord:r(2,s),normal:r(3,s),color:r(4,s,Uint8Array),indices:r(3,s/3,Uint16Array)};o.position.push(t),o.texcoord.push(e),o.normal.push(i),o.color.push(n);for(var a=0;s>a;++a)o.indices.push(a);return o}function L(t,e,n,s,o,a,u){function A(t,e,i){return t+(e-t)*i}function c(e,n,r,u,c,l){for(var f=0;o>=f;f++){var m=n/(h-1),v=f/o,w=2*(m-.5),L=(a+v*d)*Math.PI,x=Math.sin(L),D=Math.cos(L),T=A(t,e,x),y=w*s,I=D*t,S=x*T;M.push(y,I,S);var E=i.add(i.multiply([0,x,D],r),u);g.push(E),p.push(m*c+l,v)}}function l(t,e){for(var i=0;o>i;++i)w.push(t+i+0,t+i+1,e+i+0),w.push(t+i+1,e+i+1,e+i+0)}if(0>=o)throw Error("subdivisionDown must be > 0");a=a||0,u=u||1;for(var h=2,d=u-a,f=2*(o+1)*(2+h),M=r(3,f),g=r(3,f),p=r(2,f),m=0;h>m;m++){var v=2*(m/(h-1)-.5);c(e,m,[1,1,1],[0,0,0],1,0),c(e,m,[0,0,0],[v,0,0],0,0),c(n,m,[1,1,1],[0,0,0],1,0),c(n,m,[0,0,0],[v,0,0],0,1)}var w=r(3,2*o*(2+h),Uint16Array),L=o+1;return l(0*L,4*L),l(5*L,7*L),l(6*L,2*L),l(3*L,1*L),{position:M,normal:g,texcoord:p,indices:w}}function x(t,e,i,n,r,s){return m(t,t,e,i,n,r,s)}function D(t,e,i,n,s,o){if(3>i)throw Error("radialSubdivisions must be 3 or greater");if(3>n)throw Error("verticalSubdivisions must be 3 or greater");s=s||0,o=o||2*Math.PI,range=o-s;for(var a=i+1,u=n+1,A=a*u,c=r(3,A),l=r(3,A),h=r(2,A),d=r(3,i*n*2,Uint16Array),f=0;u>f;++f)for(var M=f/n,g=M*Math.PI*2,p=Math.sin(g),m=t+p*e,v=Math.cos(g),w=v*e,L=0;a>L;++L){var x=L/i,D=s+x*range,T=Math.sin(D),y=Math.cos(D),I=T*m,S=y*m,E=T*p,C=y*p;c.push(I,w,S),l.push(E,v,C),h.push(x,1-M)}for(var f=0;n>f;++f)for(var L=0;i>L;++L){var b=1+L,j=1+f;d.push(a*f+L,a*j+L,a*f+b),d.push(a*j+L,a*j+b,a*f+b)}return{position:c,normal:l,texcoord:h,indices:d}}function T(t,e,i,n,s){if(3>e)throw Error("divisions must be at least 3");i=i?i:1,s=s?s:1,n=n?n:0;for(var o=(e+1)*(i+1),a=r(3,o),u=r(3,o),A=r(2,o),c=r(3,i*e*2,Uint16Array),l=0,h=t-n,d=0;i>=d;++d){for(var f=n+h*Math.pow(d/i,s),M=0;e>=M;++M){var g=2*Math.PI*M/e,p=f*Math.cos(g),m=f*Math.sin(g);if(a.push(p,0,m),u.push(0,1,0),A.push(1-M/e,d/i),d>0&&M!==e){var v=l+(M+1),w=l+M,L=l+M-e,x=l+(M+1)-e;c.push(v,w,L),c.push(v,L,x)}}l+=e+1}return{position:a,normal:u,texcoord:A,indices:c}}function y(t){return Math.random()*t|0}function I(t,e){e=e||{};var i=t.position.numElements,n=r(4,i,Uint8Array),s=e.rand||function(t,e){return 3>e?y(256):255};if(t.color=n,t.indices)for(var o=0;i>o;++o)n.push(s(o,0),s(o,1),s(o,2),s(o,3));else for(var a=e.vertsPerColor||3,u=i/a,o=0;u>o;++o)for(var A=[s(o,0),s(o,1),s(o,2),s(o,3)],c=0;a>c;++c)n.push(A);return t}function S(e){return function(i){var n=e.apply(this,Array.prototype.slice.call(arguments,1));return t.createBuffersFromArrays(i,n)}}function E(e){return function(i){var n=e.apply(null,Array.prototype.slice.call(arguments,1));return t.createBufferInfoFromArrays(i,n)}}var C=[[3,7,5,1],[6,2,0,4],[6,7,3,2],[0,1,5,4],[7,6,4,5],[2,3,1,0]];return{create3DFBufferInfo:E(w),create3DFBuffers:S(w),create3DFVertices:w,createAugmentedTypedArray:r,createCubeBufferInfo:E(p),createCubeBuffers:S(p),createCubeVertices:p,createPlaneBufferInfo:E(M),createPlaneBuffers:S(M),createPlaneVertices:M,createSphereBufferInfo:E(g),createSphereBuffers:S(g),createSphereVertices:g,createTruncatedConeBufferInfo:E(m),createTruncatedConeBuffers:S(m),createTruncatedConeVertices:m,createXYQuadBufferInfo:E(f),createXYQuadBuffers:S(f),createXYQuadVertices:f,createCresentBufferInfo:E(L),createCresentBuffers:S(L),createCresentVertices:L,createCylinderBufferInfo:E(x),createCylinderBuffers:S(x),createCylinderVertices:x,createTorusBufferInfo:E(D),createTorusBuffers:S(D),createTorusVertices:D,createDiscBufferInfo:E(T),createDiscBuffers:S(T),createDiscVertices:T,deindexVertices:o,flattenNormals:a,makeRandomVertexColors:I,reorientDirections:c,reorientNormals:l,reorientPositions:h,reorientVertices:d}}),i("main",["twgl/twgl","twgl/m4","twgl/v3","twgl/primitives"],function(t,e,i,n){return t.m4=e,t.v3=i,t.primitives=n,t}),e(["main"],function(t){return t},void 0,!0),i("build/js/twgl-includer-full",function(){}),e("main")})},{}],4:[function(t,e,i){function n(){var t=document.createElement("video");t.addEventListener("ended",function(){t.play()}),this.request=function(){t.paused&&(t.src=o("video/mp4","AAAAGGZ0eXBpc29tAAAAAG1wNDFhdmMxAAAIA21vb3YAAABsbXZoZAAAAADSa9v60mvb+gABX5AAlw/gAAEAAAEAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAdkdHJhawAAAFx0a2hkAAAAAdJr2/rSa9v6AAAAAQAAAAAAlw/gAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAQAAAAAAQAAAAHAAAAAAAJGVkdHMAAAAcZWxzdAAAAAAAAAABAJcP4AAAAAAAAQAAAAAG3G1kaWEAAAAgbWRoZAAAAADSa9v60mvb+gAPQkAGjneAFccAAAAAAC1oZGxyAAAAAAAAAAB2aWRlAAAAAAAAAAAAAAAAVmlkZW9IYW5kbGVyAAAABodtaW5mAAAAFHZtaGQAAAABAAAAAAAAAAAAAAAkZGluZgAAABxkcmVmAAAAAAAAAAEAAAAMdXJsIAAAAAEAAAZHc3RibAAAAJdzdHNkAAAAAAAAAAEAAACHYXZjMQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAMABwASAAAAEgAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABj//wAAADFhdmNDAWQAC//hABlnZAALrNlfllw4QAAAAwBAAAADAKPFCmWAAQAFaOvssiwAAAAYc3R0cwAAAAAAAAABAAAAbgAPQkAAAAAUc3RzcwAAAAAAAAABAAAAAQAAA4BjdHRzAAAAAAAAAG4AAAABAD0JAAAAAAEAehIAAAAAAQA9CQAAAAABAAAAAAAAAAEAD0JAAAAAAQBMS0AAAAABAB6EgAAAAAEAAAAAAAAAAQAPQkAAAAABAExLQAAAAAEAHoSAAAAAAQAAAAAAAAABAA9CQAAAAAEATEtAAAAAAQAehIAAAAABAAAAAAAAAAEAD0JAAAAAAQBMS0AAAAABAB6EgAAAAAEAAAAAAAAAAQAPQkAAAAABAExLQAAAAAEAHoSAAAAAAQAAAAAAAAABAA9CQAAAAAEATEtAAAAAAQAehIAAAAABAAAAAAAAAAEAD0JAAAAAAQBMS0AAAAABAB6EgAAAAAEAAAAAAAAAAQAPQkAAAAABAExLQAAAAAEAHoSAAAAAAQAAAAAAAAABAA9CQAAAAAEATEtAAAAAAQAehIAAAAABAAAAAAAAAAEAD0JAAAAAAQBMS0AAAAABAB6EgAAAAAEAAAAAAAAAAQAPQkAAAAABAExLQAAAAAEAHoSAAAAAAQAAAAAAAAABAA9CQAAAAAEATEtAAAAAAQAehIAAAAABAAAAAAAAAAEAD0JAAAAAAQBMS0AAAAABAB6EgAAAAAEAAAAAAAAAAQAPQkAAAAABAExLQAAAAAEAHoSAAAAAAQAAAAAAAAABAA9CQAAAAAEATEtAAAAAAQAehIAAAAABAAAAAAAAAAEAD0JAAAAAAQBMS0AAAAABAB6EgAAAAAEAAAAAAAAAAQAPQkAAAAABAExLQAAAAAEAHoSAAAAAAQAAAAAAAAABAA9CQAAAAAEATEtAAAAAAQAehIAAAAABAAAAAAAAAAEAD0JAAAAAAQBMS0AAAAABAB6EgAAAAAEAAAAAAAAAAQAPQkAAAAABAExLQAAAAAEAHoSAAAAAAQAAAAAAAAABAA9CQAAAAAEATEtAAAAAAQAehIAAAAABAAAAAAAAAAEAD0JAAAAAAQBMS0AAAAABAB6EgAAAAAEAAAAAAAAAAQAPQkAAAAABAExLQAAAAAEAHoSAAAAAAQAAAAAAAAABAA9CQAAAAAEATEtAAAAAAQAehIAAAAABAAAAAAAAAAEAD0JAAAAAAQBMS0AAAAABAB6EgAAAAAEAAAAAAAAAAQAPQkAAAAABAExLQAAAAAEAHoSAAAAAAQAAAAAAAAABAA9CQAAAAAEALcbAAAAAHHN0c2MAAAAAAAAAAQAAAAEAAABuAAAAAQAAAcxzdHN6AAAAAAAAAAAAAABuAAADCQAAABgAAAAOAAAADgAAAAwAAAASAAAADgAAAAwAAAAMAAAAEgAAAA4AAAAMAAAADAAAABIAAAAOAAAADAAAAAwAAAASAAAADgAAAAwAAAAMAAAAEgAAAA4AAAAMAAAADAAAABIAAAAOAAAADAAAAAwAAAASAAAADgAAAAwAAAAMAAAAEgAAAA4AAAAMAAAADAAAABIAAAAOAAAADAAAAAwAAAASAAAADgAAAAwAAAAMAAAAEgAAAA4AAAAMAAAADAAAABIAAAAOAAAADAAAAAwAAAASAAAADgAAAAwAAAAMAAAAEgAAAA4AAAAMAAAADAAAABIAAAAOAAAADAAAAAwAAAASAAAADgAAAAwAAAAMAAAAEgAAAA4AAAAMAAAADAAAABIAAAAOAAAADAAAAAwAAAASAAAADgAAAAwAAAAMAAAAEgAAAA4AAAAMAAAADAAAABIAAAAOAAAADAAAAAwAAAASAAAADgAAAAwAAAAMAAAAEgAAAA4AAAAMAAAADAAAABIAAAAOAAAADAAAAAwAAAASAAAADgAAAAwAAAAMAAAAEgAAAA4AAAAMAAAADAAAABMAAAAUc3RjbwAAAAAAAAABAAAIKwAAACt1ZHRhAAAAI6llbmMAFwAAdmxjIDIuMi4xIHN0cmVhbSBvdXRwdXQAAAAId2lkZQAACRRtZGF0AAACrgX//6vcRem95tlIt5Ys2CDZI+7veDI2NCAtIGNvcmUgMTQyIC0gSC4yNjQvTVBFRy00IEFWQyBjb2RlYyAtIENvcHlsZWZ0IDIwMDMtMjAxNCAtIGh0dHA6Ly93d3cudmlkZW9sYW4ub3JnL3gyNjQuaHRtbCAtIG9wdGlvbnM6IGNhYmFjPTEgcmVmPTMgZGVibG9jaz0xOjA6MCBhbmFseXNlPTB4MzoweDEzIG1lPWhleCBzdWJtZT03IHBzeT0xIHBzeV9yZD0xLjAwOjAuMDAgbWl4ZWRfcmVmPTEgbWVfcmFuZ2U9MTYgY2hyb21hX21lPTEgdHJlbGxpcz0xIDh4OGRjdD0xIGNxbT0wIGRlYWR6b25lPTIxLDExIGZhc3RfcHNraXA9MSBjaHJvbWFfcXBfb2Zmc2V0PS0yIHRocmVhZHM9MTIgbG9va2FoZWFkX3RocmVhZHM9MSBzbGljZWRfdGhyZWFkcz0wIG5yPTAgZGVjaW1hdGU9MSBpbnRlcmxhY2VkPTAgYmx1cmF5X2NvbXBhdD0wIGNvbnN0cmFpbmVkX2ludHJhPTAgYmZyYW1lcz0zIGJfcHlyYW1pZD0yIGJfYWRhcHQ9MSBiX2JpYXM9MCBkaXJlY3Q9MSB3ZWlnaHRiPTEgb3Blbl9nb3A9MCB3ZWlnaHRwPTIga2V5aW50PTI1MCBrZXlpbnRfbWluPTEgc2NlbmVjdXQ9NDAgaW50cmFfcmVmcmVzaD0wIHJjX2xvb2thaGVhZD00MCByYz1hYnIgbWJ0cmVlPTEgYml0cmF0ZT0xMDAgcmF0ZXRvbD0xLjAgcWNvbXA9MC42MCBxcG1pbj0xMCBxcG1heD01MSBxcHN0ZXA9NCBpcF9yYXRpbz0xLjQwIGFxPTE6MS4wMACAAAAAU2WIhAAQ/8ltlOe+cTZuGkKg+aRtuivcDZ0pBsfsEi9p/i1yU9DxS2lq4dXTinViF1URBKXgnzKBd/Uh1bkhHtMrwrRcOJslD01UB+fyaL6ef+DBAAAAFEGaJGxBD5B+v+a+4QqF3MgBXz9MAAAACkGeQniH/+94r6EAAAAKAZ5hdEN/8QytwAAAAAgBnmNqQ3/EgQAAAA5BmmhJqEFomUwIIf/+4QAAAApBnoZFESw//76BAAAACAGepXRDf8SBAAAACAGep2pDf8SAAAAADkGarEmoQWyZTAgh//7gAAAACkGeykUVLD//voEAAAAIAZ7pdEN/xIAAAAAIAZ7rakN/xIAAAAAOQZrwSahBbJlMCCH//uEAAAAKQZ8ORRUsP/++gQAAAAgBny10Q3/EgQAAAAgBny9qQ3/EgAAAAA5BmzRJqEFsmUwIIf/+4AAAAApBn1JFFSw//76BAAAACAGfcXRDf8SAAAAACAGfc2pDf8SAAAAADkGbeEmoQWyZTAgh//7hAAAACkGflkUVLD//voAAAAAIAZ+1dEN/xIEAAAAIAZ+3akN/xIEAAAAOQZu8SahBbJlMCCH//uAAAAAKQZ/aRRUsP/++gQAAAAgBn/l0Q3/EgAAAAAgBn/tqQ3/EgQAAAA5Bm+BJqEFsmUwIIf/+4QAAAApBnh5FFSw//76AAAAACAGePXRDf8SAAAAACAGeP2pDf8SBAAAADkGaJEmoQWyZTAgh//7gAAAACkGeQkUVLD//voEAAAAIAZ5hdEN/xIAAAAAIAZ5jakN/xIEAAAAOQZpoSahBbJlMCCH//uEAAAAKQZ6GRRUsP/++gQAAAAgBnqV0Q3/EgQAAAAgBnqdqQ3/EgAAAAA5BmqxJqEFsmUwIIf/+4AAAAApBnspFFSw//76BAAAACAGe6XRDf8SAAAAACAGe62pDf8SAAAAADkGa8EmoQWyZTAgh//7hAAAACkGfDkUVLD//voEAAAAIAZ8tdEN/xIEAAAAIAZ8vakN/xIAAAAAOQZs0SahBbJlMCCH//uAAAAAKQZ9SRRUsP/++gQAAAAgBn3F0Q3/EgAAAAAgBn3NqQ3/EgAAAAA5Bm3hJqEFsmUwIIf/+4QAAAApBn5ZFFSw//76AAAAACAGftXRDf8SBAAAACAGft2pDf8SBAAAADkGbvEmoQWyZTAgh//7gAAAACkGf2kUVLD//voEAAAAIAZ/5dEN/xIAAAAAIAZ/7akN/xIEAAAAOQZvgSahBbJlMCCH//uEAAAAKQZ4eRRUsP/++gAAAAAgBnj10Q3/EgAAAAAgBnj9qQ3/EgQAAAA5BmiRJqEFsmUwIIf/+4AAAAApBnkJFFSw//76BAAAACAGeYXRDf8SAAAAACAGeY2pDf8SBAAAADkGaaEmoQWyZTAgh//7hAAAACkGehkUVLD//voEAAAAIAZ6ldEN/xIEAAAAIAZ6nakN/xIAAAAAOQZqsSahBbJlMCCH//uAAAAAKQZ7KRRUsP/++gQAAAAgBnul0Q3/EgAAAAAgBnutqQ3/EgAAAAA5BmvBJqEFsmUwIIf/+4QAAAApBnw5FFSw//76BAAAACAGfLXRDf8SBAAAACAGfL2pDf8SAAAAADkGbNEmoQWyZTAgh//7gAAAACkGfUkUVLD//voEAAAAIAZ9xdEN/xIAAAAAIAZ9zakN/xIAAAAAOQZt4SahBbJlMCCH//uEAAAAKQZ+WRRUsP/++gAAAAAgBn7V0Q3/EgQAAAAgBn7dqQ3/EgQAAAA5Bm7xJqEFsmUwIIf/+4AAAAApBn9pFFSw//76BAAAACAGf+XRDf8SAAAAACAGf+2pDf8SBAAAADkGb4EmoQWyZTAgh//7hAAAACkGeHkUVLD//voAAAAAIAZ49dEN/xIAAAAAIAZ4/akN/xIEAAAAOQZokSahBbJlMCCH//uAAAAAKQZ5CRRUsP/++gQAAAAgBnmF0Q3/EgAAAAAgBnmNqQ3/EgQAAAA5BmmhJqEFsmUwIIf/+4QAAAApBnoZFFSw//76BAAAACAGepXRDf8SBAAAACAGep2pDf8SAAAAADkGarEmoQWyZTAgh//7gAAAACkGeykUVLD//voEAAAAIAZ7pdEN/xIAAAAAIAZ7rakN/xIAAAAAPQZruSahBbJlMFEw3//7B"),t.play())},this.release=function(){t.pause(),t.src=""}}function r(){var t=null;this.request=function(){t||(t=setInterval(function(){window.location=window.location,setTimeout(window.stop,0)},3e4))},this.release=function(){t&&(clearInterval(t),t=null)}}function s(){var t=navigator.userAgent||navigator.vendor||window.opera;return t.match(/iPhone/i)||t.match(/iPod/i)?r:n}var o=function(t,e){return"data:"+t+";base64,"+e};e.exports=s()},{}],5:[function(t,e,i){function n(t,e,i,n,r,s){t.beginPath(),t.moveTo(e+s,i),t.lineTo(e+n-s,i),t.quadraticCurveTo(e+n,i,e+n,i+s),t.lineTo(e+n,i+r-s),t.quadraticCurveTo(e+n,i+r,e+n-s,i+r),t.lineTo(e+s,i+r),t.quadraticCurveTo(e,i+r,e,i+r-s),t.lineTo(e,i+s),t.quadraticCurveTo(e,i,e+s,i),t.closePath(),t.fill(),t.stroke()}function r(){this.gl=null,this.glTex=null,this.backupTex=null,this.vrTextureDescription=null,this.canvas=null,this.ctx=null}function s(t,e,i){for(var n=e.split(" "),r="",s=[],o=0,a=0,u=0,A=0;A<n.length;A++){var c=r+n[A]+" ",l=t.measureText(c);u=l.width,u>i&&A>0?(u>o&&(o=a),s.push(r),r=n[A]+" "):r=c,a=u}return s.push(r),1==s.length&&(o=u),[s,1.1*o]}VRTextureDescription=t("./VRTextureDescription.js");var o=t("../js-ext/twgl-full.js");r.prototype.initBase=function(t){this.vrTextureDescription=new VRTextureDescription,this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d"),this.ctx.canvas.width=2048,this.ctx.canvas.height=2048,this.gl=t},r.prototype.teardown=function(){},r.prototype.updateBase=function(){null!=this.gl&&(null!=this.glTex&&this.gl.deleteTexture(this.glTex),this.glTex=o.createTexture(this.gl,{min:this.gl.LINEAR,mag:this.gl.LINEAR,src:this.ctx.canvas}))},VRCanvasSpinner=function(){},VRCanvasSpinner.prototype=new r,VRCanvasSpinner.prototype.init=function(t){this.initBase(t)},VRCanvasSpinner.prototype.update=function(t){this.ctx.fillStyle="#00f",this.ctx.strokeStyle="#ff0",this.ctx.lineWidth="10",this.ctx.fillRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.beginPath(),this.ctx.arc(this.ctx.canvas.width/2,this.ctx.canvas.height/2,this.ctx.canvas.width/2.2*Math.abs(Math.cos(t)),0,2*Math.PI),this.ctx.stroke(),this.updateBase()},VRCanvasArrow=function(){},VRCanvasArrow.prototype=new r,VRCanvasArrow.prototype.init=function(t,e,i){this.initBase(t),this.ctx.canvas.width=256,this.ctx.canvas.height=256,this.isLeft=i,this.vrTextureDescription.sphereFOV=[e,e]},VRCanvasArrow.prototype.update=function(t){this.ctx.beginPath(),this.ctx.lineWidth=32,this.ctx.strokeStyle="rgba(0,0,0,1.0)",this.ctx.fillStyle="rgba(255,255,255,1.0)",0==this.isLeft?(this.ctx.moveTo(128,32),this.ctx.lineTo(224,128),this.ctx.lineTo(128,224),this.ctx.lineTo(128,168),this.ctx.lineTo(32,168),this.ctx.lineTo(32,88),this.ctx.lineTo(128,88),this.ctx.lineTo(128,32)):(this.ctx.moveTo(128,32),this.ctx.lineTo(32,128),this.ctx.lineTo(128,224),this.ctx.lineTo(128,168),this.ctx.lineTo(224,168),this.ctx.lineTo(224,88),this.ctx.lineTo(128,88),this.ctx.lineTo(128,32)),this.ctx.closePath(),this.ctx.stroke(),this.ctx.fill(),this.updateBase()},VRCanvasTextBox=function(){},VRCanvasTextBox.prototype=new r,VRCanvasTextBox.prototype.init=function(t,e,i,r){this.initBase(t);var o="Arial";null!=r.fontface&&(o=r.fontface);var a=48;null!=r.fontsize&&(a=r.fontsize);var u="center";null!=r.align&&(u=r.align);var A=12;null!=r.borderThickness&&(A=r.borderThickness);var c="#FFFFFF";null!=r.borderColor&&(c=r.borderColor);var l="#000000";null!=r.backgroundColor&&(l=r.backgroundColor);var h="#FFFFFF";null!=r.textColor&&(h=r.textColor),this.ctx.font="Bold "+a+"px "+o;var d=1.4,f=s(this.ctx,e,this.ctx.canvas.width/2),M=f[0],g=f[1];this.ctx.canvas.width=g+2*A,this.ctx.canvas.height=M.length*a*d+2*A,this.ctx.fillStyle=l,this.ctx.strokeStyle=c,this.ctx.lineWidth=A,n(this.ctx,A/2,A/2,g,M.length*a*d+A/2,6),this.ctx.fillStyle=h,this.ctx.font=a+"px "+o,this.ctx.textAlign=u;for(var p=0;p<M.length;p++){var m=M[p];"right"==u||"end"==u?this.ctx.fillText(m,g+A,(p+1)*a*d):"center"==u?this.ctx.fillText(m,g/2+A,(p+1)*a*d):("start"==u||"left"==u)&&this.ctx.fillText(m,2*A,(p+1)*a*d)}var v=this.ctx.canvas.width,w=this.ctx.canvas.height;this.vrTextureDescription.sphereFOV=[i,w*i/v]},VRCanvasTextBox.prototype.update=function(t){this.updateBase()},VRCanvasFactoryCore=function(){this.createCanvasSpinner=function(){return new VRCanvasSpinner},this.createCanvasTextBox=function(){return new VRCanvasTextBox},this.createCanvasArrow=function(){return new VRCanvasArrow}};var a=function(){function t(){var t=new VRCanvasFactoryCore;return t}var e;return{getInstance:function(){return e||(e=t()),e}}}();e.exports=a.getInstance()},{"../js-ext/twgl-full.js":3,"./VRTextureDescription.js":24}],6:[function(t,e,i){function n(){this.eulerX=0,this.eulerY=0,this.eulerZ=0,this.baseMat=twgl.m4.identity()}twgl=t("../js-ext/twgl-full.js");var r=t("./VRUtil.js"),s=new r,o=t("./VRRotMath.js"),a=new o;n.prototype.updateBase=function(t){this.baseMat=twgl.m4.identity(),twgl.m4.rotateX(this.baseMat,Math.PI,this.baseMat),twgl.m4.rotateX(this.baseMat,this.eulerX,this.baseMat),twgl.m4.rotateY(this.baseMat,this.eulerY,this.baseMat),twgl.m4.rotateZ(this.baseMat,this.eulerZ,this.baseMat),twgl.m4.copy(this.baseMat,t)},n.prototype.setEuler=function(t,e,i){this.eulerX=t,this.eulerY=e,this.eulerZ=i},n.prototype.getEuler=function(){return[this.eulerX,this.eulerY,this.eulerZ]},VRIdleSpinner=function(){},VRIdleSpinner.prototype=new n,VRIdleSpinner.prototype.update=function(t){this.setEuler(0,this.eulerZ-.01,0),this.updateBase(t)};var u=function(){function t(){var t=new VRIdleSpinner;return t}var e;return{getInstance:function(){return e||(e=t()),e}}}();VRMouseSpinner=function(){},VRMouseSpinner.prototype=new n,VRMouseSpinner.prototype.mouseMove=function(t,e,i,n){this.eulerY=this.eulerY+.01*e,this.eulerZ=this.eulerZ-.01*t},VRMouseSpinner.prototype.update=function(t){this.updateBase(t)},VRGyroSpinner=function(){this.deviceOrientation=null,this.screenOrientation=window.orientation,window.addEventListener("deviceorientation",this.onDeviceOrientationChange_.bind(this),!0),window.addEventListener("orientationchange",this.onScreenOrientationChange_.bind(this),!0),this.baseRotation=twgl.m4.identity(),this.screenTransform=twgl.m4.identity(),this.yawOffset=0,this.init=!1},VRGyroSpinner.prototype=new n,VRGyroSpinner.prototype.onDeviceOrientationChange_=function(t){this.deviceOrientation=t},VRGyroSpinner.prototype.onScreenOrientationChange_=function(t){this.screenOrientation=window.orientation},VRGyroSpinner.prototype.setYawOffset=function(t){this.yawOffset=t},VRGyroSpinner.prototype.update=function(t){if(null!=this.deviceOrientation){var e=a.gyroToMat(this.deviceOrientation.alpha,this.deviceOrientation.beta,this.deviceOrientation.gamma,this.screenOrientation,this.yawOffset);twgl.m4.copy(e[0],t);a.matToEuler(e);this.eulerX=e[1],this.eulerY=e[2],this.eulerZ=0}},VRGyroSpinner.prototype.isMobile=function(){return s.isMobile()},mobileAndTabletcheck=function(){};var A=function(){function t(){var t=new VRGyroSpinner;return t}var e;return{getInstance:function(){return e||(e=t()),e}}}();VRLookMode={MOUSE:0,IDLESPINNER:1,GYRO:2},VRLookController=function(){var t=this;this.angle=0,this.vrMouseSpinner=new VRMouseSpinner,this.vrIdleSpinner=u.getInstance(),this.vrGyroSpinner=A.getInstance(),this.camera=null,this.mode=VRLookMode.MOUSE,this.euler=[0,0,0],this.pointer=null,this.setCamera=function(e){t.camera=e},this.mouseMove=function(e,i,n,r){t.vrMouseSpinner.mouseMove(e,i,n,r),this.pointer=[n,r]},this.mouseStop=function(){this.pointer=null},this.checkModes=function(){this.vrGyroSpinner.isMobile()?this.mode=VRLookMode.GYRO:this.mode=VRLookMode.MOUSE},this.update=function(){switch(this.checkModes(),this.mode){case VRLookMode.MOUSE:this.vrMouseSpinner.update(this.camera),this.euler=this.vrMouseSpinner.getEuler();break;case VRLookMode.IDLESPINNER:this.vrIdleSpinner.update(this.camera),this.euler=this.vrIdleSpinner.getEuler();break;case VRLookMode.GYRO:this.vrGyroSpinner.update(this.camera),this.euler=this.vrGyroSpinner.getEuler()}},this.isGyro=function(){return this.mode==VRLookMode.GYRO},this.getHeading=function(){return this.mode==VRLookMode.GYRO?[this.euler[0],this.euler[1],this.euler[2]]:[-180*this.euler[2]/Math.PI,-180*this.euler[1]/Math.PI,180*this.euler[0]/Math.PI]},this.resetHeading=function(){if(this.mode==VRLookMode.GYRO){var t=(180*this.euler[0]/Math.PI+270)%360-180;this.vrGyroSpinner.setYawOffset(-1*Math.PI*t/180)}}},e.exports=VRLookController},{"../js-ext/twgl-full.js":3,"./VRRotMath.js":14,"./VRUtil.js":26}],7:[function(t,e,i){var n=t("./VRRenderModes.js"),r=t("./VRIcons.js");VRHandsets={Desktop:{width:-1,name:"Desktop browser"},Nexus5:{width:110,name:"Nexus 5"},Nexus6:{width:133,name:"Nexus 6"},GalaxyS6:{width:114,name:"Samsing Galaxy S6"},GalaxyNote4:{width:125,name:"Samsung Galaxy Note 4"},LGG3:{width:121,name:"LG G3"},iPhone4:{width:75,name:"iPhone 4"},iPhone5:{width:89,name:"iPhone 5"},iPhone6:{width:104,name:"iPhone 6"},iPhone6p:{width:112,name:"iPhone 6 plus"}},VRDevices={FULLSCREEN:{name:"Fullscreen",renderMode:n.MONOCULAR,icon:r.logoFullscreen,hfov:120,ipd:-1,ipdAdjust:0,k:[0,0]},ANAGLYPH:{name:"Red-blue glasses",renderMode:n.STEREOANAGLYPH,icon:r.logoAnaglyph,hfov:60,ipd:-1,ipdAdjust:0,k:[0,0]},CARDBOARDV2:{name:"Google Cardboard v2 (2015)",renderMode:n.STEREOSIDEBYSIDE,icon:r.logoCardboard,hfov:60,ipd:64,ipdAdjust:0,k:[.34,.55]},VIEWMASTER:{name:"View-Master VR (2016)",renderMode:n.STEREOSIDEBYSIDE,icon:r.logoCardboard,hfov:50,ipd:64,ipdAdjust:0,k:[.34,.55]},GEARVR2015:{name:"Samsung Gear VR",renderMode:n.STEREOSIDEBYSIDE,icon:r.logoCardboard,hfov:90,ipd:60,ipdAdjust:0,k:[.215,.215]},ZEISSVRONE:{name:"Zeiss VR ONE",renderMode:n.STEREOSIDEBYSIDE,icon:r.logoCardboard,hfov:90,ipd:60,ipdAdjust:0,k:[.093,.018]},CARDBOARDV1:{name:"Google Cardboard v1 (2014)",renderMode:n.STEREOSIDEBYSIDE,icon:r.logoCardboard,hfov:40,ipd:64,ipdAdjust:0,k:[.441,.156]}};var s=function(t,e,i){var n=t.ipd,r=e.width;return 0>n||0>r?0:0>i?(.5*n-.25*r)/(.5*r):(.5*i-.25*r)/(.5*r)},o=function(){var t="test",e=window.localStorage;try{return e.setItem(t,"1"),e.removeItem(t),!0}catch(i){return!1}};VRDeviceManager=function(){this.version="0.1",this.currentDeviceName="ANAGLYPH",this.currentDevice=VRDevices[this.currentDeviceName],this.windowedDevice=VRDevices.FULLSCREEN,this.currentHandsetName="Desktop",this.currentHandset=VRHandsets[this.currentHandsetName],this.windowedHandset=VRDevices.Desktop,this.userIPDOffset=64,this.overrideIPD=!1,this.useLocalStorage=!0,this.localDict=null,this.init=function(){0==o()&&(this.useLocalStorage=!1);var t=this.getCookie();null!=t&&(this.currentDeviceName=t.device,this.currentDevice=VRDevices[this.currentDeviceName],this.currentHandsetName=t.handset,this.currentHandset=VRHandsets[this.currentHandsetName],this.userIPDOffset=t.userIPDOffset,this.overrideIPD=t.overrideIPD)},this.firstTime=function(){var t=this.getCookie();return null==t},this.flushToCookie=function(){var t={device:this.currentDeviceName,handset:this.currentHandsetName,userIPDOffset:this.userIPDOffset,overrideIPD:this.overrideIPD};this.setCookie(t)},this.setCookie=function(t){if(!this.useLocalStorage)return void(this.localDict=t);var e=window.localStorage;e.vrEmbedDict_device=t.device,e.vrEmbedDict_handset=t.handset,e.vrEmbedDict_userIPDOffset=t.userIPDOffset,e.vrEmbedDict_overrideIPD=t.overrideIPD},this.getCookie=function(){if(!this.useLocalStorage)return this.localDict;var t=window.localStorage;if(void 0==t.vrEmbedDict_device||void 0==t.vrEmbedDict_handset||void 0==t.vrEmbedDict_userIPDOffset||void 0==t.vrEmbedDict_overrideIPD)return null;var e={device:t.vrEmbedDict_device,handset:t.vrEmbedDict_handset,userIPDOffset:t.vrEmbedDict_userIPDOffset,overrideIPD:t.vrEmbedDict_overrideIPD};return e},this.getDeviceList=function(){var t=[];for(var e in VRDevices)"length"!==e&&VRDevices.hasOwnProperty(e)&&t.push(e);return t},this.getHandsetList=function(){var t=[];for(var e in VRHandsets)"length"!==e&&VRHandsets.hasOwnProperty(e)&&t.push(e);return t},this.getDevice=function(t){return VRDevices[t]},this.getHandset=function(t){return VRHandsets[t]},this.setOverrideIPD=function(t){this.overrideIPD=t,this.flushToCookie()},this.setUserIPDOffset=function(t){this.userIPDOffset=t,this.flushToCookie()},this.setCurrentDevice=function(t){this.currentDeviceName=t,this.currentDevice=VRDevices[t],this.flushToCookie()},this.setCurrentHandset=function(t){this.currentHandsetName=t,this.currentHandset=VRHandsets[t],this.flushToCookie()},this.getCurrentHandset=function(){return this.currentHandset},this.getWindowedHandset=function(){return this.windowedHandset},this.getCurrentDevice=function(){return 0==this.overrideIPD?this.currentDevice.ipdAdjust=s(this.currentDevice,this.currentHandset,-1):this.currentDevice.ipdAdjust=s(this.currentDevice,this.currentHandset,this.userIPDOffset),this.currentDevice},this.getWindowedDevice=function(){return this.currentDevice.ipdAdjust=0,this.windowedDevice}};var a=function(){function t(){var t=new VRDeviceManager;return t.init(),t}var e;return{getInstance:function(){return e||(e=t()),e}}}();e.exports=a.getInstance()},{"./VRIcons.js":9,"./VRRenderModes.js":13}],8:[function(t,e,i){function n(t,e,i,n,r){var s=(t-e+i)%i,o=(n-e+i)%i,a=s-o;return a>0&&r>a?!0:!1}navigator.vibrate=navigator.vibrate||navigator.webkitVibrate||navigator.mozVibrate||navigator.msVibrate,VRGuiTimer=function(){this.canvas=null,this.callback=null,this.callbackArgs=null,this["in"]=!1,this.startTime=Number.MAX_VALUE,this.callbackFired=!1,this.timeout=1e3,this.init=function(t,e,i){this.canvas=t,this.callback=e,this.callbackArgs=i},this.isInBoundingBox=function(t,e){var i=e.sphereCentre[0]-.5*e.sphereFOV[0];if(!n(t[0],-180,360,i,e.sphereFOV[0]))return!1;var r=e.sphereCentre[1]-.5*e.sphereFOV[1];return n(t[1],-90,180,r,e.sphereFOV[1])?!0:!1},this.update=function(t,e){if(null==this.callback)return this.isInBoundingBox(t,this.canvas.vrTextureDescription)?this["in"]=!0:this["in"]=!1,0;if(this.isInBoundingBox(t,this.canvas.vrTextureDescription)){if(0==this["in"])return this["in"]=!0,this.startTime=e,this.callbackFired=!1,navigator.vibrate&&navigator.vibrate(100),0;var i=e-this.startTime;return i>this.timeout?(this.callbackFired||this.fireCallback(),0):i/this.timeout}return 1==this["in"],this["in"]=!1,this.startTime=Number.MAX_VALUE,this.callbackFired=!1,0},this.fireCallback=function(){this.callbackFired=!0,console.log("FIRING CALLBACK!"),this.callback(this.callbackArgs)}},VRGui=function(){this.canvasSet=[],this.gl=null,this.guiHover=!1,this.isHovering=function(){return this.guiHover},this.init=function(t){this.gl=t},this.teardown=function(){for(texIt=0;texIt<this.canvasSet.length;texIt++)this.canvasSet[texIt][0].teardown();
this.canvasSet=[]},this.update=function(t,e){var i=[t[0],t[1]];this.guiHover=!1;var n=0;for(texIt=0;texIt<this.canvasSet.length;texIt++){var r=this.canvasSet[texIt][1].update(i,e);r>n&&(n=r),void 0!=this.canvasSet[texIt]&&1==this.canvasSet[texIt][1]["in"]&&(this.guiHover=!0)}return n},this.createTextBox=function(t,e,i,n,r,s,o){var a=VRCanvasFactory.createCanvasTextBox();a.init(this.gl,s,t,o),a.vrTextureDescription.sphereCentre=[e,i],a.update(self.tick);var u=new VRGuiTimer;u.init(a,n,r),this.canvasSet.push([a,u])},this.createArrow=function(t,e,i,n,r,s){var o=VRCanvasFactory.createCanvasArrow();o.init(this.gl,t,s),o.vrTextureDescription.sphereCentre=[e,i],o.update(self.tick);var a=new VRGuiTimer;a.init(o,n,r),this.canvasSet.push([o,a])}},e.exports=VRGui},{}],9:[function(t,e,i){var n=function(t,e){return"data:"+t+";base64,"+e};VRLogos={logoCardboard:n("image/svg+xml","PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4NCjwhLS0gR2VuZXJhdG9yOiBBZG9iZSBJbGx1c3RyYXRvciAxNS4xLjAsIFNWRyBFeHBvcnQgUGx1Zy1JbiAuIFNWRyBWZXJzaW9uOiA2LjAwIEJ1aWxkIDApICAtLT4NCjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+DQo8c3ZnIHZlcnNpb249IjEuMSIgaWQ9ImNhcmRib2FyZF94NUZfcm91bmRlZCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayINCgkgeD0iMHB4IiB5PSIwcHgiIHdpZHRoPSIyNHB4IiBoZWlnaHQ9IjI0cHgiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZW5hYmxlLWJhY2tncm91bmQ9Im5ldyAwIDAgMjQgMjQiIHhtbDpzcGFjZT0icHJlc2VydmUiPg0KPGc+DQoJPHBhdGggZmlsbD0iI0ZGRkZGRiIgZD0iTTQsNkMzLjQ1LDYsMyw2LjQ1LDMsN3YxMGMwLDAuNTUsMC40NSwxLDEsMWg0YzAuNTUsMCwxLjMxOC0wLjMxOCwxLjcwNy0wLjcwN2wxLjU4Ni0xLjU4Ng0KCQljMC4zODktMC4zODksMS4wMTYtMC4zOCwxLjM5NCwwLjAybDEuNDYxLDEuNTQ3QzE0LjUyNSwxNy42NzMsMTUuMjg0LDE4LDE1LjgzNCwxOEgyMGMwLjU1LDAsMS0wLjQ1LDEtMVY3YzAtMC41NS0wLjQ1LTEtMS0xSDR6DQoJCSBNNy41LDE1Yy0xLjY1NiwwLTMtMS4zNDQtMy0zczEuMzQ0LTMsMy0zczMsMS4zNDQsMywzUzkuMTU2LDE1LDcuNSwxNXogTTE2LjUsMTVjLTEuNjU2LDAtMy0xLjM0NC0zLTNzMS4zNDQtMywzLTNzMywxLjM0NCwzLDMNCgkJUzE4LjE1NiwxNSwxNi41LDE1eiIvPg0KCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzFEMUQxQiIgc3Ryb2tlLXdpZHRoPSIwLjIiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgZD0iTTQsNkMzLjQ1LDYsMyw2LjQ1LDMsN3YxMGMwLDAuNTUsMC40NSwxLDEsMWg0DQoJCWMwLjU1LDAsMS4zMTgtMC4zMTgsMS43MDctMC43MDdsMS41ODYtMS41ODZjMC4zODktMC4zODksMS4wMTYtMC4zOCwxLjM5NCwwLjAybDEuNDYxLDEuNTQ3QzE0LjUyNSwxNy42NzMsMTUuMjg0LDE4LDE1LjgzNCwxOEgyMA0KCQljMC41NSwwLDEtMC40NSwxLTFWN2MwLTAuNTUtMC40NS0xLTEtMUg0eiBNNy41LDE1Yy0xLjY1NiwwLTMtMS4zNDQtMy0zczEuMzQ0LTMsMy0zczMsMS4zNDQsMywzUzkuMTU2LDE1LDcuNSwxNXogTTE2LjUsMTUNCgkJYy0xLjY1NiwwLTMtMS4zNDQtMy0zczEuMzQ0LTMsMy0zczMsMS4zNDQsMywzUzE4LjE1NiwxNSwxNi41LDE1eiIvPg0KPC9nPg0KPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjMUQxRDFCIiBzdHJva2Utd2lkdGg9IjAuMiIgc3Ryb2tlLW1pdGVybGltaXQ9IjEwIiBkPSJNOSwxMmMwLDAuODI5LTAuNjcxLDEuNS0xLjUsMS41Ii8+DQo8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiMxRDFEMUIiIHN0cm9rZS13aWR0aD0iMC4yIiBzdHJva2UtbWl0ZXJsaW1pdD0iMTAiIGQ9Ik0xOCwxMmMwLDAuODI5LTAuNjcxLDEuNS0xLjUsMS41Ii8+DQo8L3N2Zz4NCg=="),logoFullscreen:n("image/svg+xml","PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4NCjwhLS0gR2VuZXJhdG9yOiBBZG9iZSBJbGx1c3RyYXRvciAxNS4xLjAsIFNWRyBFeHBvcnQgUGx1Zy1JbiAuIFNWRyBWZXJzaW9uOiA2LjAwIEJ1aWxkIDApICAtLT4NCjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+DQo8c3ZnIHZlcnNpb249IjEuMSIgaWQ9ImZ1bGxzY3JlZW5fMV8iIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCINCgkgeT0iMHB4IiB3aWR0aD0iMjRweCIgaGVpZ2h0PSIyNHB4IiB2aWV3Qm94PSIwIDAgMjQgMjQiIGVuYWJsZS1iYWNrZ3JvdW5kPSJuZXcgMCAwIDI0IDI0IiB4bWw6c3BhY2U9InByZXNlcnZlIj4NCjxwb2x5Z29uIGZpbGw9IiNGRkZGRkYiIHN0cm9rZT0iIzFEMUQxQiIgc3Ryb2tlLXdpZHRoPSIwLjIiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgcG9pbnRzPSIzLDMgMyw5IDAsOSAwLDAgOSwwIDksMyAiLz4NCjxwb2x5Z29uIGZpbGw9IiNGRkZGRkYiIHN0cm9rZT0iIzFEMUQxQiIgc3Ryb2tlLXdpZHRoPSIwLjIiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgcG9pbnRzPSIzLDIxIDksMjEgOSwyNCAwLDI0IDAsMTUgMywxNSAiLz4NCjxwb2x5Z29uIGZpbGw9IiNGRkZGRkYiIHN0cm9rZT0iIzFEMUQxQiIgc3Ryb2tlLXdpZHRoPSIwLjIiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgcG9pbnRzPSIyMSwyMSAyMSwxNSAyNCwxNSAyNCwyNCAxNSwyNCAxNSwyMSANCgkiLz4NCjxwb2x5Z29uIGZpbGw9IiNGRkZGRkYiIHN0cm9rZT0iIzFEMUQxQiIgc3Ryb2tlLXdpZHRoPSIwLjIiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgcG9pbnRzPSIyMSwzIDE1LDMgMTUsMCAyNCwwIDI0LDkgMjEsOSAiLz4NCjwvc3ZnPg0K"),logoWindowed:n("image/svg+xml","PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4NCjwhLS0gR2VuZXJhdG9yOiBBZG9iZSBJbGx1c3RyYXRvciAxNS4xLjAsIFNWRyBFeHBvcnQgUGx1Zy1JbiAuIFNWRyBWZXJzaW9uOiA2LjAwIEJ1aWxkIDApICAtLT4NCjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+DQo8c3ZnIHZlcnNpb249IjEuMSIgaWQ9IndpbmRvd2VkXzFfIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB4PSIwcHgiDQoJIHk9IjBweCIgd2lkdGg9IjI0cHgiIGhlaWdodD0iMjRweCIgdmlld0JveD0iMCAwIDI0IDI0IiBlbmFibGUtYmFja2dyb3VuZD0ibmV3IDAgMCAyNCAyNCIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+DQo8cG9seWdvbiBmaWxsPSIjRkZGRkZGIiBzdHJva2U9IiMxRDFEMUIiIHN0cm9rZS13aWR0aD0iMC4yIiBzdHJva2UtbWl0ZXJsaW1pdD0iMTAiIHBvaW50cz0iNiw2IDYsMCA5LDAgOSw5IDAsOSAwLDYgIi8+DQo8cG9seWdvbiBmaWxsPSIjRkZGRkZGIiBzdHJva2U9IiMxRDFEMUIiIHN0cm9rZS13aWR0aD0iMC4yIiBzdHJva2UtbWl0ZXJsaW1pdD0iMTAiIHBvaW50cz0iNiwxOCAwLDE4IDAsMTUgOSwxNSA5LDI0IDYsMjQgIi8+DQo8cG9seWdvbiBmaWxsPSIjRkZGRkZGIiBzdHJva2U9IiMxRDFEMUIiIHN0cm9rZS13aWR0aD0iMC4yIiBzdHJva2UtbWl0ZXJsaW1pdD0iMTAiIHBvaW50cz0iMTgsMTggMTgsMjQgMTUsMjQgMTUsMTUgMjQsMTUgMjQsMTggDQoJIi8+DQo8cG9seWdvbiBmaWxsPSIjRkZGRkZGIiBzdHJva2U9IiMxRDFEMUIiIHN0cm9rZS13aWR0aD0iMC4yIiBzdHJva2UtbWl0ZXJsaW1pdD0iMTAiIHBvaW50cz0iMTgsNiAyNCw2IDI0LDkgMTUsOSAxNSwwIDE4LDAgIi8+DQo8L3N2Zz4NCg=="),logoAnaglyph:n("image/svg+xml","PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4NCjwhLS0gR2VuZXJhdG9yOiBBZG9iZSBJbGx1c3RyYXRvciAxNS4xLjAsIFNWRyBFeHBvcnQgUGx1Zy1JbiAuIFNWRyBWZXJzaW9uOiA2LjAwIEJ1aWxkIDApICAtLT4NCjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+DQo8c3ZnIHZlcnNpb249IjEuMSIgaWQ9ImFuYWdseXBoX3g1Rl9yb3VuZGVkIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIg0KCSB4PSIwcHgiIHk9IjBweCIgd2lkdGg9IjI0cHgiIGhlaWdodD0iMjRweCIgdmlld0JveD0iMCAwIDI0IDI0IiBlbmFibGUtYmFja2dyb3VuZD0ibmV3IDAgMCAyNCAyNCIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+DQo8cmVjdCB4PSI0LjUiIHk9IjEwLjUiIGZpbGw9IiMzNkE5RTEiIHN0cm9rZT0iIzFEMUQxQiIgc3Ryb2tlLXdpZHRoPSIwLjUiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgd2lkdGg9IjYiIGhlaWdodD0iMyIvPg0KPHJlY3QgeD0iMTMuNSIgeT0iMTAuNSIgZmlsbD0iI0JFMTYyMiIgc3Ryb2tlPSIjMUQxRDFCIiBzdHJva2Utd2lkdGg9IjAuNSIgc3Ryb2tlLW1pdGVybGltaXQ9IjEwIiB3aWR0aD0iNiIgaGVpZ2h0PSIzIi8+DQo8Zz4NCgk8cGF0aCBmaWxsPSIjRkZGRkZGIiBkPSJNMy41LDcuNUMzLjIyNSw3LjUsMyw3LjcyNSwzLDh2OGMwLDAuMjc1LDAuMjI1LDAuNSwwLjUsMC41SDEwYzAuMjc1LDAsMC42NTktMC4xNTksMC44NTQtMC4zNTQNCgkJbDAuNzkzLTAuNzkzYzAuMTk0LTAuMTk0LDAuNTEzLTAuMTk0LDAuNzA3LDBsMC43OTMsMC43OTNDMTMuMzQxLDE2LjM0MSwxMy43MjUsMTYuNSwxNCwxNi41aDYuNWMwLjI3NSwwLDAuNS0wLjIyNSwwLjUtMC41VjgNCgkJYzAtMC4yNzUtMC4yMjUtMC41LTAuNS0wLjVIMy41eiBNMTAuNSwxM2MwLDAuMjc1LTAuMjI1LDAuNS0wLjUsMC41SDVjLTAuMjc1LDAtMC41LTAuMjI1LTAuNS0wLjV2LTJjMC0wLjI3NSwwLjIyNS0wLjUsMC41LTAuNWg1DQoJCWMwLjI3NSwwLDAuNSwwLjIyNSwwLjUsMC41VjEzeiBNMTkuNSwxM2MwLDAuMjc1LTAuMjI1LDAuNS0wLjUsMC41aC01Yy0wLjI3NSwwLTAuNS0wLjIyNS0wLjUtMC41di0yYzAtMC4yNzUsMC4yMjUtMC41LDAuNS0wLjVoNQ0KCQljMC4yNzUsMCwwLjUsMC4yMjUsMC41LDAuNVYxM3oiLz4NCgk8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiMxRDFEMUIiIHN0cm9rZS13aWR0aD0iMC41IiBzdHJva2UtbWl0ZXJsaW1pdD0iMTAiIGQ9Ik0zLjUsNy41QzMuMjI1LDcuNSwzLDcuNzI1LDMsOHY4DQoJCWMwLDAuMjc1LDAuMjI1LDAuNSwwLjUsMC41SDEwYzAuMjc1LDAsMC42NTktMC4xNTksMC44NTQtMC4zNTRsMC43OTMtMC43OTNjMC4xOTQtMC4xOTQsMC41MTMtMC4xOTQsMC43MDcsMGwwLjc5MywwLjc5Mw0KCQlDMTMuMzQxLDE2LjM0MSwxMy43MjUsMTYuNSwxNCwxNi41aDYuNWMwLjI3NSwwLDAuNS0wLjIyNSwwLjUtMC41VjhjMC0wLjI3NS0wLjIyNS0wLjUtMC41LTAuNUgzLjV6IE0xMC41LDEzDQoJCWMwLDAuMjc1LTAuMjI1LDAuNS0wLjUsMC41SDVjLTAuMjc1LDAtMC41LTAuMjI1LTAuNS0wLjV2LTJjMC0wLjI3NSwwLjIyNS0wLjUsMC41LTAuNWg1YzAuMjc1LDAsMC41LDAuMjI1LDAuNSwwLjVWMTN6IE0xOS41LDEzDQoJCWMwLDAuMjc1LTAuMjI1LDAuNS0wLjUsMC41aC01Yy0wLjI3NSwwLTAuNS0wLjIyNS0wLjUtMC41di0yYzAtMC4yNzUsMC4yMjUtMC41LDAuNS0wLjVoNWMwLjI3NSwwLDAuNSwwLjIyNSwwLjUsMC41VjEzeiIvPg0KPC9nPg0KPC9zdmc+DQo="),logoSettings:n("image/svg+xml","PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4NCjwhLS0gR2VuZXJhdG9yOiBBZG9iZSBJbGx1c3RyYXRvciAxNS4xLjAsIFNWRyBFeHBvcnQgUGx1Zy1JbiAuIFNWRyBWZXJzaW9uOiA2LjAwIEJ1aWxkIDApICAtLT4NCjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+DQo8c3ZnIHZlcnNpb249IjEuMSIgaWQ9InNldHRpbmdzIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB4PSIwcHgiIHk9IjBweCINCgkgd2lkdGg9IjI0cHgiIGhlaWdodD0iMjRweCIgdmlld0JveD0iMCAwIDI0IDI0IiBlbmFibGUtYmFja2dyb3VuZD0ibmV3IDAgMCAyNCAyNCIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+DQo8Zz4NCgk8cGF0aCBmaWxsPSIjRkZGRkZGIiBkPSJNMTksMTMuNWMwLjI3NSwwLDAuNS0wLjIyNSwwLjUtMC41di0yYzAtMC4yNzUtMC4yMjUtMC41LTAuNS0wLjVoLTAuNjk2Yy0wLjI3NSwwLTAuNTcxLTAuMjEzLTAuNjU5LTAuNDc0DQoJCWwtMC4yNTctMC42MjJjLTAuMTIzLTAuMjQ2LTAuMDY0LTAuNjA2LDAuMTMtMC44MDFsMC40OTMtMC40OTNjMC4xOTQtMC4xOTQsMC4xOTQtMC41MTMsMC0wLjcwN0wxNi41OTcsNS45OQ0KCQljLTAuMTk0LTAuMTk0LTAuNTEzLTAuMTk0LTAuNzA3LDBsLTAuNDkzLDAuNDkzYy0wLjE5NCwwLjE5NC0wLjU1NSwwLjI1My0wLjgwMSwwLjEzbC0wLjYyMi0wLjI1Ng0KCQlDMTMuNzEzLDYuMjY5LDEzLjUsNS45NzIsMTMuNSw1LjY5N1Y1YzAtMC4yNzUtMC4yMjUtMC41LTAuNS0wLjVoLTJjLTAuMjc1LDAtMC41LDAuMjI1LTAuNSwwLjV2MC42OTcNCgkJYzAsMC4yNzUtMC4yMTMsMC41NzEtMC40NzQsMC42NTlMOS40MDQsNi42MTJjLTAuMjQ2LDAuMTIzLTAuNjA2LDAuMDY0LTAuODAxLTAuMTNMOC4xMTEsNS45ODljLTAuMTk0LTAuMTk0LTAuNTEzLTAuMTk0LTAuNzA3LDANCgkJTDUuOTksNy40MDNjLTAuMTk0LDAuMTk0LTAuMTk0LDAuNTEzLDAsMC43MDdsMC40OTMsMC40OTNjMC4xOTQsMC4xOTQsMC4yNTMsMC41NTUsMC4xMywwLjgwMWwtMC4yNTcsMC42MjMNCgkJQzYuMjY4LDEwLjI4Nyw1Ljk3MiwxMC41LDUuNjk3LDEwLjVINWMtMC4yNzUsMC0wLjUsMC4yMjUtMC41LDAuNXYyYzAsMC4yNzUsMC4yMjUsMC41LDAuNSwwLjVoMC42OTcNCgkJYzAuMjc1LDAsMC41NzEsMC4yMTMsMC42NTksMC40NzRsMC4yNTYsMC42MjJjMC4xMjMsMC4yNDYsMC4wNjQsMC42MDYtMC4xMywwLjgwMWwtMC40OTMsMC40OTJjLTAuMTk0LDAuMTk0LTAuMTk0LDAuNTEzLDAsMC43MDcNCgkJbDEuNDE0LDEuNDE0YzAuMTk0LDAuMTk0LDAuNTEzLDAuMTk0LDAuNzA3LDBsMC40OTItMC40OTJjMC4xOTQtMC4xOTQsMC41NTUtMC4yNTMsMC44MDEtMC4xM2wwLjYyMywwLjI1Nw0KCQljMC4yNjEsMC4wODgsMC40NzQsMC4zODQsMC40NzQsMC42NTlWMTljMCwwLjI3NSwwLjIyNSwwLjUsMC41LDAuNWgyYzAuMjc1LDAsMC41LTAuMjI1LDAuNS0wLjV2LTAuNjk2DQoJCWMwLTAuMjc1LDAuMjEzLTAuNTcxLDAuNDc0LTAuNjU5bDAuNjIyLTAuMjU2YzAuMjQ2LTAuMTIzLDAuNjA2LTAuMDY0LDAuODAxLDAuMTNsMC40OTIsMC40OTJjMC4xOTQsMC4xOTQsMC41MTMsMC4xOTQsMC43MDcsMA0KCQlsMS40MTQtMS40MTRjMC4xOTQtMC4xOTQsMC4xOTQtMC41MTMsMC0wLjcwN2wtMC40OTItMC40OTJjLTAuMTk0LTAuMTk0LTAuMjUzLTAuNTU1LTAuMTMtMC44MDFsMC4yNTctMC42MjMNCgkJYzAuMDg4LTAuMjYxLDAuMzg0LTAuNDc0LDAuNjU5LTAuNDc0SDE5eiBNMTIsMTMuNWMtMC44MjksMC0xLjUtMC42NzEtMS41LTEuNWMwLTAuODI4LDAuNjcxLTEuNSwxLjUtMS41czEuNSwwLjY3MSwxLjUsMS41DQoJCUMxMy41LDEyLjgyOSwxMi44MjksMTMuNSwxMiwxMy41eiIvPg0KCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzFEMUQxQiIgc3Ryb2tlLXdpZHRoPSIwLjIiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgZD0iTTE5LDEzLjVjMC4yNzUsMCwwLjUtMC4yMjUsMC41LTAuNXYtMg0KCQljMC0wLjI3NS0wLjIyNS0wLjUtMC41LTAuNWgtMC42OTZjLTAuMjc1LDAtMC41NzEtMC4yMTMtMC42NTktMC40NzRsLTAuMjU3LTAuNjIyYy0wLjEyMy0wLjI0Ni0wLjA2NC0wLjYwNiwwLjEzLTAuODAxDQoJCWwwLjQ5My0wLjQ5M2MwLjE5NC0wLjE5NCwwLjE5NC0wLjUxMywwLTAuNzA3TDE2LjU5Nyw1Ljk5Yy0wLjE5NC0wLjE5NC0wLjUxMy0wLjE5NC0wLjcwNywwbC0wLjQ5MywwLjQ5Mw0KCQljLTAuMTk0LDAuMTk0LTAuNTU1LDAuMjUzLTAuODAxLDAuMTNsLTAuNjIyLTAuMjU2QzEzLjcxMyw2LjI2OSwxMy41LDUuOTcyLDEzLjUsNS42OTdWNWMwLTAuMjc1LTAuMjI1LTAuNS0wLjUtMC41aC0yDQoJCWMtMC4yNzUsMC0wLjUsMC4yMjUtMC41LDAuNXYwLjY5N2MwLDAuMjc1LTAuMjEzLDAuNTcxLTAuNDc0LDAuNjU5TDkuNDA0LDYuNjEyYy0wLjI0NiwwLjEyMy0wLjYwNiwwLjA2NC0wLjgwMS0wLjEzTDguMTExLDUuOTg5DQoJCWMtMC4xOTQtMC4xOTQtMC41MTMtMC4xOTQtMC43MDcsMEw1Ljk5LDcuNDAzYy0wLjE5NCwwLjE5NC0wLjE5NCwwLjUxMywwLDAuNzA3bDAuNDkzLDAuNDkzYzAuMTk0LDAuMTk0LDAuMjUzLDAuNTU1LDAuMTMsMC44MDENCgkJbC0wLjI1NywwLjYyM0M2LjI2OCwxMC4yODcsNS45NzIsMTAuNSw1LjY5NywxMC41SDVjLTAuMjc1LDAtMC41LDAuMjI1LTAuNSwwLjV2MmMwLDAuMjc1LDAuMjI1LDAuNSwwLjUsMC41aDAuNjk3DQoJCWMwLjI3NSwwLDAuNTcxLDAuMjEzLDAuNjU5LDAuNDc0bDAuMjU2LDAuNjIyYzAuMTIzLDAuMjQ2LDAuMDY0LDAuNjA2LTAuMTMsMC44MDFsLTAuNDkzLDAuNDkyYy0wLjE5NCwwLjE5NC0wLjE5NCwwLjUxMywwLDAuNzA3DQoJCWwxLjQxNCwxLjQxNGMwLjE5NCwwLjE5NCwwLjUxMywwLjE5NCwwLjcwNywwbDAuNDkyLTAuNDkyYzAuMTk0LTAuMTk0LDAuNTU1LTAuMjUzLDAuODAxLTAuMTNsMC42MjMsMC4yNTcNCgkJYzAuMjYxLDAuMDg4LDAuNDc0LDAuMzg0LDAuNDc0LDAuNjU5VjE5YzAsMC4yNzUsMC4yMjUsMC41LDAuNSwwLjVoMmMwLjI3NSwwLDAuNS0wLjIyNSwwLjUtMC41di0wLjY5Ng0KCQljMC0wLjI3NSwwLjIxMy0wLjU3MSwwLjQ3NC0wLjY1OWwwLjYyMi0wLjI1NmMwLjI0Ni0wLjEyMywwLjYwNi0wLjA2NCwwLjgwMSwwLjEzbDAuNDkyLDAuNDkyYzAuMTk0LDAuMTk0LDAuNTEzLDAuMTk0LDAuNzA3LDANCgkJbDEuNDE0LTEuNDE0YzAuMTk0LTAuMTk0LDAuMTk0LTAuNTEzLDAtMC43MDdsLTAuNDkyLTAuNDkyYy0wLjE5NC0wLjE5NC0wLjI1My0wLjU1NS0wLjEzLTAuODAxbDAuMjU3LTAuNjIzDQoJCWMwLjA4OC0wLjI2MSwwLjM4NC0wLjQ3NCwwLjY1OS0wLjQ3NEgxOXogTTEyLDEzLjVjLTAuODI5LDAtMS41LTAuNjcxLTEuNS0xLjVjMC0wLjgyOCwwLjY3MS0xLjUsMS41LTEuNXMxLjUsMC42NzEsMS41LDEuNQ0KCQlDMTMuNSwxMi44MjksMTIuODI5LDEzLjUsMTIsMTMuNXoiLz4NCjwvZz4NCjwvc3ZnPg0K"),logoVrEmbed:n("image/svg+xml","PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz48IURPQ1RZUEUgc3ZnIFBVQkxJQyAiLS8vVzNDLy9EVEQgU1ZHIDEuMSBUaW55Ly9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLXRpbnkuZHRkIj48c3ZnIHZlcnNpb249IjEuMSIgYmFzZVByb2ZpbGU9InRpbnkiIGlkPSJsb2dvMiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgeD0iMHB4IiB5PSIwcHgiIHdpZHRoPSIyNHB4IiBoZWlnaHQ9IjI0cHgiIHZpZXdCb3g9IjAgMCAyNCAyNCIgb3ZlcmZsb3c9ImluaGVyaXQiIHhtbDpzcGFjZT0icHJlc2VydmUiPjxjaXJjbGUgZmlsbD0iI0ZGRkZGRiIgc3Ryb2tlPSIjMUQxRDFCIiBzdHJva2UtbWl0ZXJsaW1pdD0iMTAiIGN4PSIxMi4wNDIiIGN5PSIxMi4wNDIiIHI9IjExLjI1Ii8+PHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjNjY2NjY2IiBzdHJva2UtbWl0ZXJsaW1pdD0iMTAiIGQ9Ik0yMSwxMi4wODNjMC01LjAwOS00LjAyNS05LjA2Mi05LTkuMDYyIi8+PGc+PHBhdGggZmlsbD0iIzFEMUQxQiIgZD0iTTUuMzU3LDguODA3aDAuODk2TDUuMSwxMkg0LjIyTDMuMDc1LDguODA3aDAuOTM4YzAuMjIyLDAuNzg1LDAuNDQzLDEuNTcsMC42NjUsMi4zNTVDNC45MDQsMTAuMzc3LDUuMTMsOS41OTIsNS4zNTcsOC44MDdMNS4zNTcsOC44MDd6Ii8+PHBhdGggZmlsbD0iIzFEMUQxQiIgZD0iTTguMjEyLDguNzMyYzAuMTU3LDAuMDE0LDAuMDcyLDAuNjk0LDAuMDcyLDAuODZDNi45MzEsOS40NDEsNy4yNzEsMTEuMTA1LDcuMjcxLDEySDYuNDNWOC44MDdoMC43OTd2MC41NTdDNy40NSw4Ljk5NCw3Ljc0Myw4LjY4OSw4LjIxMiw4LjczMkM4LjIyMyw4LjczMyw4LjIwMiw4LjczMSw4LjIxMiw4LjczMnoiLz48cGF0aCBmaWxsPSIjRkY5OTAwIiBkPSJNNi42NSwxMy4xNzZINC4zNjV2MC45MTZoMi4wOTh2MC43NUg0LjM2NXYxLjExMWgyLjM5MXYwLjc3NUgzLjQ4M3YtNC4zMThjMC43MjIsMCwxLjQ0MywwLDIuMTY1LDBjMC4zMTMsMCwwLjYyNiwwLDAuOTM5LDBDNi43MjksMTIuNDExLDYuNjUsMTMuMDM1LDYuNjUsMTMuMTc2TDYuNjUsMTMuMTc2eiIvPjxwYXRoIGZpbGw9IiNGRjk5MDAiIGQ9Ik0xMS4wODgsMTMuNTQ3YzAuOTM2LDAuMzc0LDAuNTgsMi4zODksMC41NzcsMy4xODJIMTAuODF2LTIuMDMzYzAtMC40NC0wLjQ5LTAuNzE5LTAuODM0LTAuMzk0Yy0wLjE5OSwwLjE4Ny0wLjE3OSwwLjQ3Ni0wLjE3OSwwLjcyNGMwLDAuNTY4LDAsMS4xMzYsMCwxLjcwM0g4Ljk1NXYtMS45YzAtMC45OTMtMS4wMi0wLjY4OC0xLjAyLDAuMTc5YzAsMC41NzMsMCwxLjE0NywwLDEuNzIySDcuMDg5di0zLjE4OEg3Ljl2MC40NjdjMC4zOTctMC42MzcsMS40NjQtMC44MTMsMS43OSwwLjAwMkM5Ljk3MywxMy41MjYsMTAuNTcyLDEzLjM0MSwxMS4wODgsMTMuNTQ3QzExLjIyNSwxMy42MDIsMTAuOTUxLDEzLjQ5MiwxMS4wODgsMTMuNTQ3eiIvPjxwYXRoIGZpbGw9IiNGRjk5MDAiIGQ9Ik0xNC44NzcsMTMuOTJjMS4wOTQsMS4zODQtMC43LDQuMTIyLTEuOTMzLDIuNDA4YzAsMC4xMy0wLjAxOSwwLjI3MiwwLDAuNGgtMC44MjN2LTQuMzEyaDAuODM1djEuNTM1QzEzLjQxMiwxMy4zMTUsMTQuMzkxLDEzLjMwMiwxNC44NzcsMTMuOTJDMTUuMTE2LDE0LjIyMywxNC42MzksMTMuNjE3LDE0Ljg3NywxMy45MnogTTE0LjE3OSwxNS44NjVjMC41MS0wLjczNy0wLjI5My0yLjQwOC0xLjA1NC0xLjQzOEMxMi41MjEsMTUuMTk2LDEzLjQ5MywxNi44NTYsMTQuMTc5LDE1Ljg2NUMxNC4yOTksMTUuNjkxLDE0LjA1OSwxNi4wMzksMTQuMTc5LDE1Ljg2NXoiLz48cGF0aCBmaWxsPSIjRkY5OTAwIiBkPSJNMTcuNjA4LDEzLjZjMC43MDgsMC4zMTYsMC44NDQsMS4wNzUsMC44MzQsMS43NjhjLTAuNzc1LDAtMS41NTEsMC0yLjMyNiwwYzAuMDI0LDAuNjA2LDAuNzIyLDEuMDg2LDEuMjU4LDAuNjQ2YzAuMzM5LTAuMjc3LDAuNTUtMC4yMTksMS4wMjQtMC4yMTljLTAuMTcsMS40My0yLjU1NywxLjMtMy4wMDEsMC4xMzNDMTQuODQ3LDE0LjQ4MiwxNi4wNjcsMTIuOTEsMTcuNjA4LDEzLjZDMTcuODMxLDEzLjY5OSwxNy4zODYsMTMuNSwxNy42MDgsMTMuNnogTTE2LjM1OSwxNC4zMjJjLTAuMTI3LDAuMTQxLTAuMjAxLDAuMzA1LTAuMjIzLDAuNDk0YzAuNDc5LDAsMC45NTksMCwxLjQzOCwwQzE3LjUzNSwxNC4yNDcsMTYuNzk4LDEzLjg2NSwxNi4zNTksMTQuMzIyQzE2LjI0MSwxNC40NDMsMTYuNDc4LDE0LjE5OSwxNi4zNTksMTQuMzIyeiIvPjxwYXRoIGZpbGw9IiNGRjk5MDAiIGQ9Ik0yMC4yNywxMy41ODdjMC4xNTIsMC4wODYsMC4yNzQsMC4yMDQsMC4zNjYsMC4zNTNjMC0wLjUwOCwwLTEuMDE1LDAtMS41MjNoMC44NDd2NC4zMTJoLTAuODEydi0wLjQ0MWMtMC43MjcsMS4xNTYtMi4xNTYsMC4zMDEtMi4yODQtMC43OTlDMTguMjcxLDE0LjQ5NSwxOS4wMTQsMTIuODc3LDIwLjI3LDEzLjU4N0MyMC40MiwxMy42NzIsMjAuMTE5LDEzLjUwMiwyMC4yNywxMy41ODd6IE0yMC40NzUsMTUuODYxYzAuNTU4LTAuNzk3LTAuNDM0LTIuNDEyLTEuMDcxLTEuMzk2QzE4LjkzOSwxNS4yMjQsMTkuNzUzLDE2Ljg5MywyMC40NzUsMTUuODYxQzIwLjU5OCwxNS42ODYsMjAuMzUyLDE2LjAzNywyMC40NzUsMTUuODYxeiIvPjwvZz48L3N2Zz4="),logoShare:n("image/svg+xml","PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz48IURPQ1RZUEUgc3ZnIFBVQkxJQyAiLS8vVzNDLy9EVEQgU1ZHIDEuMS8vRU4iICJodHRwOi8vd3d3LnczLm9yZy9HcmFwaGljcy9TVkcvMS4xL0RURC9zdmcxMS5kdGQiPjxzdmcgdmVyc2lvbj0iMS4xIiBpZD0ic2hhcmVzaGVldCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgeD0iMHB4IiB5PSIwcHgiIHdpZHRoPSIyNHB4IiBoZWlnaHQ9IjI0cHgiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZW5hYmxlLWJhY2tncm91bmQ9Im5ldyAwIDAgMjQgMjQiIHhtbDpzcGFjZT0icHJlc2VydmUiPjxnPjxnPjxwYXRoIGZpbGw9IiNGRkZGRkYiIHN0cm9rZT0iIzFEMUQxQiIgc3Ryb2tlLXdpZHRoPSIwLjIiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgZD0iTTE4Ljc1LDE1Yy0wLjk5NCwwLTEuODkzLDAuMzk1LTIuNTYzLDEuMDI2bC03LjMxOC0zLjA5MUM4Ljk0NiwxMi42MzUsOSwxMi4zMjUsOSwxMnMtMC4wNTQtMC42MzUtMC4xMzItMC45MzZsNy4zMTgtMy4wOTFDMTYuODU2LDguNjA1LDE3Ljc1NSw5LDE4Ljc1LDljMi4wNywwLDMuNzUtMS42OCwzLjc1LTMuNzVjMC0yLjA3MS0xLjY4LTMuNzUtMy43NS0zLjc1UzE1LDMuMTc5LDE1LDUuMjVjMCwwLjI1NywwLjAyNiwwLjUwNywwLjA3NSwwLjc0OWwtNy40MywzLjEzOEM2Ljk5NCw4LjU5Miw2LjE2Niw4LjI1LDUuMjUsOC4yNUMzLjE3OSw4LjI1LDEuNSw5LjkyOSwxLjUsMTJjMCwyLjA3LDEuNjc5LDMuNzUsMy43NSwzLjc1YzAuOTE3LDAsMS43NDUtMC4zNDIsMi4zOTYtMC44ODhMMTUuMDc1LDE4QzE1LjAyNiwxOC4yNDMsMTUsMTguNDkzLDE1LDE4Ljc1YzAsMi4wNywxLjY4LDMuNzUsMy43NSwzLjc1czMuNzUtMS42OCwzLjc1LTMuNzVTMjAuODIsMTUsMTguNzUsMTV6Ii8+PC9nPjwvZz48L3N2Zz4=")},e.exports=VRLogos},{}],10:[function(t,e,i){var n=t("./VRTextureDescription.js"),r=t("./VRTextOptions.js");VRJump=function(){this.jumpElm=null,this.textureDescription=null,this.textOptions=null,this.jumpTo=null,this.jumpText=null,this.init=function(t){this.jumpElm=t,this.jumpElm.setAttribute("hidden",!0),this.textureDescription=new n,this.textureDescription.setSphereParamsFromString(this.jumpElm.getAttribute("sphereParams")),this.jumpTo=this.jumpElm.getAttribute("jumpTo"),""==this.jumpElm.innerHTML?this.jumpText=this.jumpTo:this.jumpText=this.jumpElm.innerHTML,this.textOptions=new r,this.textOptions.init(this.jumpElm)},this.initDict=function(t){this.textureDescription=new n,this.textureDescription.initDict(t.textureDescription),this.jumpTo=t.jumpTo,this.jumpText=t.jumpText,this.textOptions=new r,this.textOptions.initDict(t.textOptions)},this.getJumpElement=function(){var t=document.createElement("jump");return t.setAttribute("sphereParams",this.textureDescription.getSphereParamsString()),t.setAttribute("jumpTo",this.jumpTo),t.innerHTML=this.jumpText,this.textOptions.setElement(t),t}},e.exports=VRJump},{"./VRTextOptions.js":23,"./VRTextureDescription.js":24}],11:[function(t,e,i){Wakelock=t("../js-ext/wakelock.js"),VRManager=function(t){this.quad=t,this.fallbackFullscreen=!1,this.fallbackScroll=null,this.fallbackParent=null,this.fallbackTmpCanvas=null,this.wakelock=new Wakelock,this.isLandscape=function(){return window.innerWidth>window.innerHeight?!0:!1},this.render=function(t){this.quad.render()},this.exitVR=function(){if(1==this.fallbackFullscreen){this.quad.getContainer();window.onscroll=this.fallbackScroll,this.fallbackFullscreen=!1,this.fallbackParent.appendChild(this.quad.getContainer()),document.body.removeChild(this.fallbackTmpCanvas),this.fallbackScroll=null,this.fallbackParent=null,this.fallbackTmpCanvas=null}else document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen();this.wakelock.release(),this.quad.vrtwglQuad.setCanvasWindowed()},this.enterFullscreen=function(){var t=this.quad.getContainer();if(t.requestFullscreen)this.fallbackFullscreen=!1,t.requestFullscreen();else if(t.mozRequestFullScreen)this.fallbackFullscreen=!1,t.mozRequestFullScreen();else if(t.webkitRequestFullscreen)this.fallbackFullscreen=!1,t.webkitRequestFullscreen();else{if(0==this.isLandscape())return alert("Please rotate device to landscape mode before activating"),!1;this.fallbackParent=t.parentNode,this.fallbackTmpCanvas=document.createElement("div"),this.fallbackTmpCanvas.style.background="#000000",this.fallbackTmpCanvas.appendChild(this.quad.getContainer()),document.body.appendChild(this.fallbackTmpCanvas),this.fallbackFullscreen=!0,this.fallbackTmpCanvas.style.zDepth=1e3,this.fallbackTmpCanvas.style.top=0,this.fallbackTmpCanvas.style.right=0,this.fallbackTmpCanvas.style.bottom=0,this.fallbackTmpCanvas.style.left=0,this.fallbackTmpCanvas.style.position="absolute",this.fallbackTmpCanvas.scrollIntoView(!0),this.fallbackScroll=window.onscroll,window.onscroll=function(){this.fallbackTmpCanvas.scrollIntoView(!0)}}return this.quad.vrtwglQuad.setCanvasFullscreen(),this.quad.resize(),this.wakelock.request(),!0}},e.exports=VRManager},{"../js-ext/wakelock.js":4}],12:[function(t,e,i){function n(){var t=this;this.vrDeviceManager=o,this.story=null,this.headsetSelector=null,this.displaySelector=null,this.ipdCheckbox=null,this.ipdSlider=null,this.ipdSliderText=null,this.init=function(){this.dialog=document.createElement("div");var t=this.dialog.style;t.position="fixed",t.top="0",t.right="0",t.bottom="0",t.left="0",t.background="rgba(0,0,0,0.8)",t.zIndex="99999",t.opacity="1",t.pointerEvents="auto",t.color="#000",t.fontFamily='"Helvetica Neue", Helvetica, Arial, sans-serif',t.fontWeight="bold",this.dialogText=document.createElement("div");var e=this.dialogText.style;a(e),e.minHeight="60px",this.dialogDevices=document.createElement("div");var i=this.dialogDevices.style;a(i),i.maxHeight="200px",i.overflow="scroll",i.overflowy="scroll",this.dialogShare=document.createElement("div");var n=this.dialogShare.style;a(n),n.maxHeight="100px",n.overflow="scroll",this.dialog.appendChild(this.dialogText),this.dialog.appendChild(this.dialogDevices),this.dialog.appendChild(this.dialogShare),this.dialog.addEventListener("click",this.onClickLeft_.bind(this)),this.dialog.addEventListener("touchstart",this.onClickLeft_.bind(this)),this.setupDialogOptions(),this.setupDialogDevices(),this.setupDialogShare(null)},this.setupDialogOptions=function(){var t="";t+="<img src="+r.logoVrEmbed+' width=60px style="float: left; margin: 2px 2px 2px 2px;"/>',t+='<a href="http://vrEmbed.org" target="_blank" style="color: inherit; text-decoration: none;">',t+='<br/>vrEmbed.org</a><br/><span style="font-size:70%">(c) Bhautik Joshi 2015-16</span><div style="clear:left;">',this.dialogText.innerHTML=t},this.setupDialogSetup=function(){var t="";t+="<img src="+r.logoVrEmbed+' width=60px style="float: right; margin: 0 0 2px 2px;"/>',t+='<b>Scroll to browse & select device:</b><br/><div style="clear:left;">',this.dialogText.innerHTML=t},this.createHeadsetSelector=function(t){var e=this.vrDeviceManager.getDeviceList(),i=document.createElement("select");for(deviceit=0;deviceit<e.length;deviceit++){var n=e[deviceit],r=this.vrDeviceManager.getDevice(n),s=document.createElement("option");s.value=n;var o=document.createTextNode(r.name);s.appendChild(o),i.appendChild(s)}t.appendChild(document.createTextNode("Select headset: ")),t.appendChild(i),t.appendChild(document.createElement("br")),i.onchange=this.syncManagerToDeviceButtons,this.headsetSelector=i},this.createDisplaySelector=function(t){var e=this.vrDeviceManager.getHandsetList(),i=document.createElement("select");for(deviceit=0;deviceit<e.length;deviceit++){var n=e[deviceit],r=this.vrDeviceManager.getHandset(n),s=document.createElement("option");s.value=n;var o=document.createTextNode(r.name);s.appendChild(o),i.appendChild(s)}t.appendChild(document.createTextNode("Select display: ")),t.appendChild(i),t.appendChild(document.createElement("br")),i.onchange=this.syncManagerToDeviceButtons,this.displaySelector=i},this.createUserOffsetSlider=function(t){var e=document.createElement("input");e.type="checkbox";var i=document.createElement("input");i.type="range",i.min=50,i.max=80,i.style.width="100px";var n=document.createTextNode("0mm");this.ipdCheckbox=e,this.ipdSlider=i,this.ipdSliderText=n,this.ipdCheckbox.onchange=this.userIPDChange,this.ipdSlider.onchange=this.userIPDChange,t.appendChild(document.createTextNode("Override IPD: ")),t.appendChild(this.ipdCheckbox),t.appendChild(this.ipdSlider),t.appendChild(this.ipdSliderText)},this.userIPDChange=function(){t.ipdCheckbox.checked?t.setupIPDOverride(1):t.setupIPDOverride(0),t.ipdSliderText.nodeValue=t.ipdSlider.value+"mm",t.syncManagerToDeviceButtons()},this.syncDeviceButtonsToManager=function(){var e=t.vrDeviceManager.currentDeviceName;t.headsetSelector.value=e;var i=t.vrDeviceManager.currentHandsetName;t.displaySelector.value=i;var n=t.vrDeviceManager.userIPDOffset;t.ipdSlider.value=n,t.ipdSliderText.nodeValue=n+"mm";var r=t.vrDeviceManager.overrideIPD;t.setupIPDOverride(r)},this.setupIPDOverride=function(e){0==e?(t.ipdCheckbox.checked=!1,t.ipdSlider.disabled=!0,t.ipdSliderText.nodeValue=""):(t.ipdCheckbox.checked=!0,t.ipdSlider.disabled=!1,t.ipdSliderText.nodeValue=t.vrDeviceManager.userIPDOffset+"mm")},this.syncManagerToDeviceButtons=function(){t.vrDeviceManager.setCurrentHandset(t.displaySelector.value),t.vrDeviceManager.setCurrentDevice(t.headsetSelector.value),t.vrDeviceManager.setUserIPDOffset(t.ipdSlider.value),t.ipdCheckbox.checked?t.vrDeviceManager.setOverrideIPD(1):t.vrDeviceManager.setOverrideIPD(0)},this.setupDialogDevices=function(){var t="";t+='<span style="font-size:120%">Setup headset:<br/>',this.dialogDevices.innerHTML=t,this.createHeadsetSelector(this.dialogDevices),this.createDisplaySelector(this.dialogDevices),this.createUserOffsetSlider(this.dialogDevices),this.syncDeviceButtonsToManager()},this.setupShareButton=function(t,e,i){t.style.borderRadius="10px",t.style.padding="5px",t.style.margin="5px",t.style.backgroundColor=e,t.style.fontSize="80%",t.style.color="#fff",t.innerHTML=i},this.setupDialogShare=function(t){if(this.dialogShare.innerHTML='<span style="font-size:120%">Share:<br/>',null!=t){var e=t[0],i=t[1],n="https://twitter.com/intent/tweet?text="+encodeURIComponent("Check out my #vrEmbed ")+e,r="https://www.facebook.com/sharer/sharer.php?u="+e,s="https://plus.google.com/share?url="+e,o="http://www.reddit.com/submit?url="+e,a=document.createElement("div");a.style.textAlign="center";var u=document.createElement("span"),A='<a href="'+n+'" target="_blank" style="color: inherit; text-decoration: none;">Twitter</a>';this.setupShareButton(u,"#00aced",A),a.appendChild(u);var c=document.createElement("span"),l='<a href="'+r+'" target="_blank" style="color: inherit; text-decoration: none;">Facebook</a>';this.setupShareButton(c,"#3b5998",l),a.appendChild(c);var h=document.createElement("span"),d='<a href="'+s+'" target="_blank" style="color: inherit; text-decoration: none;">G+</a>';this.setupShareButton(h,"#dd4b39",d),a.appendChild(h);var f=document.createElement("span"),M='<a href="'+o+'" target="_blank" style="color: inherit; text-decoration: none;">Reddit</a>';this.setupShareButton(f,"#ff5700",M),a.appendChild(f),this.dialogShare.appendChild(a);var g=document.createElement("div"),p=document.createElement("span");p.style.fontSize="120%",p.innerHTML="Embed:",g.appendChild(p);var m=document.createElement("input");m.setAttribute("value",i),m.style.width="100%",m.style.fontWeight="normal",m.style.fontFamily='"Courier New", Courier, "Lucida Sans Typewriter", "Lucida Typewriter", monospace',g.appendChild(m),this.dialogShare.appendChild(g)}},this.showDialogOptions=function(){this.setupDialogOptions(),this.dialogDevices.style.display="block",this.dialogShare.style.display="none",document.body.appendChild(this.dialog),this.syncDeviceButtonsToManager()},this.showDialogShare=function(t){this.setupDialogShare(t),this.dialogDevices.style.display="none",this.dialogShare.style.display="block",document.body.appendChild(this.dialog)},this.showDialogOptionsFirstTime=function(t){this.setupDialogSetup(),this.dialogDevices.style.display="block",this.dialogShare.style.display="none",document.body.appendChild(this.dialog),this.syncDeviceButtonsToManager(),this.story=t},this.hideDialog=function(){document.body.removeChild(this.dialog),this.syncManagerToDeviceButtons(),null!=this.story&&(this.story.stateToggler.setState(s.FULLSCREEN),this.story=null)},this.onClickLeft_=function(t){var e=!1;t.target==this.dialog&&(e=!0),t.target==this.dialogText&&(e=!0),t.target==this.dialogDevices&&(e=!0),t.target==this.dialogShare&&(e=!0),0!=e&&(t.stopPropagation(),t.preventDefault(),this.hideDialog())}}var r=t("./VRIcons.js"),s=t("./VRStates.js"),o=t("./VRDeviceManager.js"),a=function(t){t.width="350px",t.position="relative",t.margin="10px auto",t.padding="10px 10px 10px 10px",t.borderRadius="5px",t.borderStlyle="solid",t.borderColor="#ff0000 #0000ff",t.background="#fff"},u=function(){function t(){var t=new n;return t.init(),t}var e;return{getInstance:function(){return e||(e=t()),e}}}();VROptions=function(){this.options=u.getInstance()},e.exports=VROptions},{"./VRDeviceManager.js":7,"./VRIcons.js":9,"./VRStates.js":18}],13:[function(t,e,i){VRRenderModes={MONOCULAR:0,STEREOSIDEBYSIDE:1,STEREOANAGLYPH:2},e.exports=VRRenderModes},{}],14:[function(t,e,i){function n(t,e){var i=twgl.m4.identity(),n=twgl.v3.create(0,0,1);twgl.m4.axisRotate(i,n,t,i);var r=twgl.v3.create(0,1,0);return twgl.m4.axisRotate(i,r,e,i),i}function r(t){var e,i,n,r=Math.cos(t.yaw),s=Math.sin(t.yaw),o=Math.cos(t.pitch),a=Math.sin(t.pitch),u=Math.cos(t.roll),A=Math.sin(t.roll),c=[s*A-r*a*u,-r*o,r*a*A+s*u,o*u,-a,-o*A,s*a*u+r*A,s*o,-s*a*A+r*u];return c[3]>.9999?(e=Math.atan2(c[2],c[8]),n=Math.PI/2,i=0):c[3]<-.9999?(e=Math.atan2(c[2],c[8]),n=-Math.PI/2,i=0):(e=Math.atan2(-c[6],c[0]),i=Math.atan2(-c[5],c[4]),n=Math.asin(c[3])),{yaw:e,pitch:n,roll:i}}twgl=t("../js-ext/twgl-full.js");var s=function(t){var e=Math.atan2(-t[2],t[0]),i=Math.atan2(-t[9],t[5]),n=Math.asin(t[1]);return[e,i,n]};VRRotMath=function(){this.timer=0,this.gyroToMat=function(t,e,i,n,s){var o=Math.PI/180,a=r({yaw:t*o,pitch:e*o,roll:i*o}),u=twgl.m4.identity();twgl.m4.rotateY(u,-a.pitch,u),twgl.m4.rotateZ(u,Math.PI+-a.yaw,u),twgl.m4.rotateX(u,Math.PI,u);var A=(360+-180*a.yaw/Math.PI)%360-180,c=-180*a.pitch/Math.PI;return[u,A,c]},this.matToEuler=function(t){return s(t)},this.rotateZX=function(t,e){return n(t,e)}},e.exports=VRRotMath},{"../js-ext/twgl-full.js":3}],15:[function(t,e,n){var r=t("./VRScenePhoto.js"),s=t("./VRText.js"),o=t("./VRJump.js");VRScene=function(){this.sceneElement=null,this.photoObjects=[],this.textObjects=[],this.jumpObjects=[],this.oldScroll=null,this.isStereo=!1,this.name="",this.parseChildNode=function(t){if("PHOTO"==t.nodeName){var e=new r;e.init(t),1==e.isStereo()&&(this.isStereo=!0),this.photoObjects.push(e)}else if("TEXT"==t.nodeName){var i=new s;i.init(t),this.textObjects.push(i)}else if("JUMP"==t.nodeName){var n=new o;n.init(t),this.jumpObjects.push(n)}for(var a=t.childNodes,u=0,A=a.length;A>u;++u){var c=a[u];1===c.nodeType&&this.parseChildNode(c)}},this.init=function(t){this.sceneElement=t;var e=t.getAttribute("name");null!=e&&(this.name=e);for(var i=t.childNodes,n=0,r=i.length;r>n;++n){var s=i[n];1===s.nodeType&&this.parseChildNode(s)}},this.initDict=function(t){this.photoObjects=[],this.textObjects=[],this.jumpObjects=[];for(var e=0,i=t.photoObjects.length;i>e;++e){var n=new r;n.initDict(t.photoObjects[e]),this.photoObjects.push(n)}for(var e=0,i=t.textObjects.length;i>e;++e){var a=new s;a.initDict(t.textObjects[e]),this.textObjects.push(a)}for(var e=0,i=t.jumpObjects.length;i>e;++e){var u=new o;u.initDict(t.jumpObjects[e]),this.jumpObjects.push(u);
}this.name=t.name},this.initVrEmbedPhoto=function(t){var e=new r;e.init(t),1==e.isStereo()&&(this.isStereo=!0),this.photoObjects.push(e)},this.initFromURLSource=function(t){1==t.isStereo()&&(this.isStereo=!0),this.photoObjects.push(t)},this.getSceneElement=function(){var t=document.createElement("scene");for(""!=this.name&&t.setAttribute("name",this.name),i=0;i<this.photoObjects.length;i++)t.appendChild(this.photoObjects[i].getPhotoElement());for(j=0;j<this.textObjects.length;j++)t.appendChild(this.textObjects[j].getTextElement());for(k=0;k<this.jumpObjects.length;k++)t.appendChild(this.jumpObjects[k].getJumpElement());return t},this.hasJumpNav=function(){return 0!=this.jumpObjects.length}},e.exports=VRScene},{"./VRJump.js":10,"./VRScenePhoto.js":16,"./VRText.js":22}],16:[function(t,e,i){var n=t("./VRTextureDescription.js");VRScenePhoto=function(){this.scenePhoto=null,this.textureDescription=null,this.parseBoolString=function(t){return void 0==t?!1:"true"==t.toLowerCase()?!0:!1},this.init=function(t){return this.scenePhoto=t,this.textureDescription=new n,this.textureDescription.textureSource=this.scenePhoto.getAttribute("src"),null==this.textureDescription.textureSource?void(this.textureDescription=null):(this.textureDescription.metaSource="",this.textureDescription.isStereo=this.parseBoolString(this.scenePhoto.getAttribute("isStereo")),this.textureDescription.plane=this.parseBoolString(this.scenePhoto.getAttribute("plane")),this.textureDescription.setSphereParamsFromString(this.scenePhoto.getAttribute("sphereParams")),void(this.isStereo()&&this.textureDescription.setTexParamsFromString(this.scenePhoto.getAttribute("texParams"))))},this.initDict=function(t){this.textureDescription=new n,this.textureDescription.initDict(t.textureDescription)},this.initFromURL=function(t){return this.textureDescription=new n,this.textureDescription.textureSource=t.src,void 0==this.textureDescription.textureSource?void(this.textureDescription=null):(void 0!=t.metaSrc?this.textureDescription.metaSource=t.metaSrc:this.textureDescription.metaSource="",this.textureDescription.isStereo=this.parseBoolString(t.isStereo),this.textureDescription.plane=this.parseBoolString(t.plane),void 0!=t.sphereParams?this.textureDescription.setSphereParamsFromString(t.sphereParams):this.textureDescription.setSphereParamsFromString("360,180,0,0"),void(void 0!=t.texParams?this.textureDescription.setTexParamsFromString(t.texParams):this.textureDescription.setTexParamsFromString("0,0,1,1,0,0,1,1")))},this.populateElementCommon=function(t){return t.setAttribute("src",this.textureDescription.getAbsoluteTexturePath()),t.setAttribute("sphereParams",this.textureDescription.getSphereParamsString()),0==this.isPlane()?t.setAttribute("plane","false"):t.setAttribute("plane","true"),0==this.isStereo()?void t.setAttribute("isStereo","false"):(t.setAttribute("isStereo","true"),void t.setAttribute("texParams",this.textureDescription.getTexParamsString()))},this.isStereo=function(){return this.textureDescription.isStereo},this.isPlane=function(){return this.textureDescription.plane},this.getPhotoElement=function(){var t=document.createElement("photo");return this.populateElementCommon(t),t},this.getSinglePhotoVrEmbedElement=function(){var t=document.createElement("a");return t.setAttribute("class","vrEmbedPhoto"),this.populateElementCommon(t),t},this.getSinglePhotoURLParams=function(){var t="?";return t+="src="+this.textureDescription.getAbsoluteTexturePath(),t+="&sphereParams="+this.textureDescription.getSphereParamsString(),0==this.isStereo()?t+="&isStereo=false":(t+="&isStereo=true",t+="&texParams="+this.textureDescription.getTexParamsString()),t+=0==this.isPlane()?"&plane=false":"&plane=true"}},e.exports=VRScenePhoto},{"./VRTextureDescription.js":24}],17:[function(t,e,i){var n=t("./VRStates.js"),r=t("./VRIcons.js"),s=t("../js-ext/emitter.js");VRStateToggler=function(){this.vrStory=null,this.createButtons(),this.buttonVR.addEventListener("click",this.onClickMiddle_.bind(this)),this.buttonOptions.addEventListener("click",this.onClickOptions_.bind(this)),this.buttonShare.addEventListener("click",this.onClickShare_.bind(this)),this.buttonVRClick.prototype=new function(){},this.buttonOptionsClick.prototype=new function(){},this.buttonShareClick.prototype=new function(){},this.logoCardboard=r.logoCardboard,this.logoFullscreen=r.logoFullscreen,this.logoWindowed=r.logoWindowed,this.logoSettings=r.logoSettings,this.logoVrEmbed=r.logoVrEmbed,this.logoShare=r.logoShare},VRStateToggler.prototype=new s,VRStateToggler.prototype.setVRStory=function(t){this.vrStory=t,this.isStereo=!1};var o=function(t){t.position="absolute",t.marginLeft="auto",t.marginRight="auto",t.width="40px",t.height="40px",t.backgroundSize="cover",t.backgroundColor="transparent",t.border=0,t.userSelect="none",t.webkitUserSelect="none",t.MozUserSelect="none",t.cursor="pointer",t.opacity="1.0"};VRStateToggler.prototype.createMiddleButton=function(){this.buttonVR=document.createElement("img");var t=this.buttonVR.style;o(t),t.left=0,t.right=0,t.width="64px",t.height="64px",t.bottom="8px",this.buttonVR.draggable=!1,this.buttonVR.addEventListener("dragstart",function(t){t.preventDefault()})},VRStateToggler.prototype.createOptionsButton=function(){this.buttonOptions=document.createElement("img");var t=this.buttonOptions.style;o(t),t.left=0,t.right=20,t.bottom="8px",this.buttonOptions.draggable=!1,this.buttonOptions.addEventListener("dragstart",function(t){t.preventDefault()})},VRStateToggler.prototype.createShareButton=function(){this.buttonShare=document.createElement("img");var t=this.buttonShare.style;o(t),t.left=20,t.right=0,t.bottom="8px",this.buttonShare.draggable=!1,this.buttonShare.addEventListener("dragstart",function(t){t.preventDefault()})},VRStateToggler.prototype.createButtons=function(){this.createMiddleButton(),this.createOptionsButton(),this.createShareButton()},VRStateToggler.prototype.onClickMiddle_=function(t){t.stopPropagation(),t.preventDefault(),this.buttonVRClick()},VRStateToggler.prototype.onClickOptions_=function(t){t.stopPropagation(),t.preventDefault(),this.buttonOptionsClick()},VRStateToggler.prototype.onClickShare_=function(t){t.stopPropagation(),t.preventDefault(),this.buttonShareClick()},VRStateToggler.prototype.setupButton=function(t,e,i,n){t.style.display="inline-block",t.offsetHeight,t.style.display="block",t.src=e,t.title=i,t.style.display=n?"inline-block":"none"},VRStateToggler.prototype.configureStereo=function(t){this.isStereo=t},VRStateToggler.prototype.setButtonState=function(t){switch(t){case n.FULLSCREEN:this.setupButton(this.buttonOptions,"","",!1),this.setupButton(this.buttonShare,"","",!1),this.setupButton(this.buttonVR,this.logoWindowed,"Windowed mode",!0);break;case n.WINDOWED:this.setupButton(this.buttonOptions,this.logoSettings,"Settings",!0),this.setupButton(this.buttonShare,this.logoShare,"Share",!0),this.setupButton(this.buttonVR,this.logoCardboard,"Fullscreen mode",!0)}},VRStateToggler.prototype.setState=function(t){if(null!=this.vrStory){var e=this.vrStory.setState(t);if(0==e)return void console.log("STATE CHANGE FAIL")}else this.emit(t);this.setButtonState(t)},VRStateToggler.prototype.stateChange=function(t){switch(t){case this.logoCardboard:this.setState(n.FULLSCREEN);break;case this.logoWindowed:this.setState(n.WINDOWED)}},VRStateToggler.prototype.buttonVRClick=function(){this.stateChange(this.buttonVR.src)},VRStateToggler.prototype.buttonOptionsClick=function(){this.vrStory.showOptions()},VRStateToggler.prototype.buttonShareClick=function(){this.vrStory.showShare()},e.exports=VRStateToggler},{"../js-ext/emitter.js":2,"./VRIcons.js":9,"./VRStates.js":18}],18:[function(t,e,i){VRStates={INACTIVE:0,WINDOWED:1,FULLSCREEN:2},e.exports=VRStates},{}],19:[function(t,e,n){var r=t("./VRStates.js"),s=t("./VRStateToggler.js"),o=t("./VRScene.js"),a=t("./VRManager.js"),u=t("./VRRenderModes.js"),A=t("./VRDeviceManager.js"),c=t("./VRGui.js"),l=t("./VROptions.js");VRStory=function(){var e=this;this.storyElement=null,this.parentElement=null,this.vrDeviceManager=A,this.vrGui=null,this.noGui=!1,this.vrOptions=new l,this.direction=[0,0,0],this.mousePosLast=[-1,-1],this.quad=null,this.manager=null,this.storyManager=null,this.stateToggler=new s,this.stateToggler.setVRStory(this),this.state=r.INACTIVE,this.lastVisibleCheck=0,this.isVisible=!0,this.isStereo=!1,this.currentSceneIndex=0,this.isFullScreen=!1,this.sceneList=[],this.namedSceneMap=[],this.enterFullscreen=function(){return this.vrDeviceManager.firstTime()?(console.log("FIRST"),this.vrOptions.options.showDialogOptionsFirstTime(e),!1):0==e.manager.enterFullscreen()?!1:(this.isFullScreen=!0,void(1==e.manager.fallbackFullscreen&&e.onResize()))},this.exitFullscreen=function(){this.isFullScreen&&null!=e.manager&&(e.manager.exitVR(),this.isFullScreen=!1)},this.windowedCallback=function(){return null==e.quad?!1:(e.quad.setupFromDevice(this.vrDeviceManager.getWindowedDevice()),e.exitFullscreen(),console.log("WINDOWED CALLBACK"),!0)},this.fullscreenCallback=function(){return 0==e.enterFullscreen()?!1:(e.quad.setupFromDevice(this.vrDeviceManager.getCurrentDevice()),console.log("FULLSCREEN CALLBACK"),!0)},this.onResize=function(){this.parentElement.clientWidth,this.parentElement.clientHeight;if(null!=this.quad){if(1==this.manager.fallbackFullscreen&&0==this.manager.isLandscape())return void this.stateToggler.setState(r.WINDOWED);if(this.isFullScreen){if(this.quad.resize(),1==this.manager.fallbackFullscreen){var t=this.quad.getContainer();t.style.width=window.innerWidth+"px",t.style.height=window.innerHeight+"px"}}else this.quad.resize()}else console.log("SHOULD NEVER BE HERE")},this.setState=function(t){var i=e.state;e.state=t;var n=!1;switch(t){case r.FULLSCREEN:n=e.fullscreenCallback();break;case r.WINDOWED:n=e.windowedCallback()}return 1==n?(e.state=t,this.onResize()):e.state=i,n},this.setupSceneRenderer=function(){this.parentElement.clientWidth,this.parentElement.clientHeight;VRtwglQuadStereoProjection=t("./VRtwglQuadStereoProjection.js"),this.quad=new VRtwglQuadStereoProjection,this.quad.init(this.parentElement),this.quad.resize()},this.createImageFromSphereTexture=function(){return this.quad.createImageFromSphereTexture()},this.isInViewport=function(){var t=this.quad.getDrawCanvas(),e=t.getBoundingClientRect(),i=window.innerHeight||document.documentElement.clientHeight,n=window.innerWidth||document.documentElement.clientWidth;return e.right<0||e.left>n?!1:e.bottom<0||e.top>i?!1:!0},this.checkVisible=function(){var t=Date.now();t-this.lastVisibleCheck<100||(this.isVisible=this.isInViewport())},this.animPow=function(t){return 2*(Math.pow(2,t)/2-.5)},this.animate=function(t){if(this.checkVisible(),0!=this.isVisible&&(e.manager.render(t),null!=e.vrGui)){var i=Date.now(),n=[],n=e.quad.controller.getHeading();this.direction[0]=n[0],this.direction[1]=n[1],this.direction[2]=0,this.vrGui.isHovering()?e.quad.setGuiMult(Math.min(1,e.quad.getGuiMult()+.05)):e.quad.setGuiMult(Math.max(.7,e.quad.getGuiMult()-.05));var r=0;if(null!=this.direction[0]&&(r=e.vrGui.update([this.direction[0],this.direction[1]],i)),e.clearCtx(),e.drawReticle(r),0==e.quad.texReady){var s=Math.min((i-e.quad.textureLoadStartAnim)/(e.quad.textureLoadEndAnim-e.quad.textureLoadStartAnim),1);s>=.01&&e.drawLoader(i,this.animPow(s))}else{var s=Math.min((i-e.quad.textureLoadStartAnim)/(e.quad.textureLoadEndAnim-e.quad.textureLoadStartAnim),1);s>=.01&&e.drawLoader(i,this.animPow(1-s))}}},this.clearCtx=function(){var t=this.quad.vrtwglQuad.get2dContext();if(null!=t){var e=t[0],i=t[1],n=t[2];e.clearRect(0,0,i,n)}},this.drawLoader=function(t,e){var i=this.quad.vrtwglQuad.get2dContext();if(null!=i){var n=i[0],r=(i[1],i[2],t%1500/1500),s=2*Math.PI*r,o="#ffffff",a="#000000",u="#666666",A="#ff9900",c=this.getReticlePositions();for(objit=0;objit<c.length;objit++){var l=c[objit];n.beginPath(),n.lineWidth=12,n.strokeStyle=a,n.fillStyle=o,n.arc(l[0],l[1],100*e,0,2*Math.PI),n.fill(),n.stroke(),n.beginPath(),n.strokeStyle=u,n.arc(l[0],l[1],80*e,s,s+.5*Math.PI),n.stroke(),n.beginPath(),n.strokeStyle=A,n.arc(l[0],l[1],60*e,-2*s,-2*s+.1*Math.PI),n.stroke()}}},this.getReticlePositions=function(){var t=this.quad.vrtwglQuad.get2dContext();if(null!=t){var e=(t[0],t[1]),i=t[2],n=[],r=this.quad.getRenderMode();if(r!=u.STEREOSIDEBYSIDE)n.push([e/2,i/2]);else{var s=this.quad.getIPDAdjust();n.push([e/4-s*e/2,i/2]),n.push([3*e/4+s*e/2,i/2])}return n}},this.drawReticle=function(t){var e=this.quad.vrtwglQuad.get2dContext();if(null!=e){var i=e[0],n=this.getReticlePositions();for(objit=0;objit<n.length;objit++){var r=n[objit],s=.6*t+.4;i.beginPath(),i.lineWidth=6,i.strokeStyle="rgba(255,255,255,"+s+")",i.arc(r[0],r[1],15,0,2*Math.PI),i.stroke(),i.beginPath(),i.strokeStyle="rgba(0,0,0,1.0)",i.lineWidth=5,i.arc(r[0],r[1],15,-.5*Math.PI,-.5*Math.PI+2*t*Math.PI),i.stroke()}}},this.setupScene=function(t){this.vrGui.teardown(),this.quad.teardown(),this.currentSceneIndex=t;var e=this.sceneList[t],i=[];if(void 0!=e)for(objit=0;objit<e.photoObjects.length;objit++){var n=e.photoObjects[objit];null!=n.textureDescription&&i.push(n.textureDescription)}this.quad.loadTextures(i),void 0!=e&&this.guiGen(),this.stateToggler.configureStereo(this.isStereo)},this.nextScene=function(){var t=e.sceneList.length,i=(e.currentSceneIndex+1)%t;i!=e.currentSceneIndex&&(e.setupScene(i),e.currentSceneIndex=i)},this.prevScene=function(){var t=e.sceneList.length,i=(e.currentSceneIndex-1)%t;i!=e.currentSceneIndex&&e.setupScene(i)},this.gotoNamedScene=function(t){e.setupScene(e.namedSceneMap[t])},this.guiGen=function(){var t=this.sceneList[this.currentSceneIndex],i=t.textObjects;for(g=0;g<i.length;g++){var n=i[g];this.vrGui.createTextBox(n.textureDescription.sphereFOV[0],n.textureDescription.sphereCentre[0],n.textureDescription.sphereCentre[1],null,null,n.message,n.textOptions)}if(0==t.hasJumpNav()){var r=e.sceneList.length;e.currentSceneIndex>0&&this.vrGui.createArrow(15,-30,-40,this.prevScene,null,!0),e.currentSceneIndex<r-1&&this.vrGui.createArrow(15,30,-40,this.nextScene,null,!1)}else{var s=t.jumpObjects;for(g=0;g<s.length;g++){var o=s[g];this.vrGui.createTextBox(o.textureDescription.sphereFOV[0],o.textureDescription.sphereCentre[0],o.textureDescription.sphereCentre[1],this.gotoNamedScene,o.jumpTo,o.jumpText+" ➦",o.textOptions)}}this.quad.renderGui()},this.init=function(t,i){this.storyElement=t,this.storyManager=i,this.parentElement=this.storyElement.parentNode,this.setupSceneRenderer(),this.vrGui=new c,this.vrGui.init(this.quad.getContext()),this.quad.setVrGui(this.vrGui),this.setupScene(this.currentSceneIndex),this.mouseMove=function(t){var i=t.movementX||t.mozMovementX||t.webkitMovementX||0,n=t.movementY||t.mozMovementY||t.webkitMovementY||0;t=t||window.event;var r=t.target||t.srcElement,s=r.getBoundingClientRect(),o=t.clientX-s.left,a=t.clientY-s.top;if(e.mousePosLast[0]<0)return void(e.mousePosLast=[t.clientX,t.clientY]);if(0==i&&0==n){var u=t.clientX-e.mousePosLast[0],A=t.clientY-e.mousePosLast[1];i=Math.min(u,5),n=Math.min(A,5)}e.mousePosLast=[t.clientX,t.clientY],e.quad.controller.mouseMove(i,n,o/s.width,a/s.height)},this.parentElement.addEventListener("mousedown",function(t){this.parentElement.addEventListener("mousemove",e.mouseMove,!1),e.mouseMove(t)},!1),this.parentElement.addEventListener("mouseup",function(t){e.quad.controller.mouseStop(),this.parentElement.removeEventListener("mousemove",e.mouseMove,!1),e.mousePosLast=[-1,-1]},!1),0==this.noGui&&(this.quad.getContainer().appendChild(this.stateToggler.buttonVR),this.quad.getContainer().appendChild(this.stateToggler.buttonOptions),this.quad.getContainer().appendChild(this.stateToggler.buttonShare)),this.manager=new a(this.quad),this.onResize(),this.animate(),this.stateToggler.setState(r.WINDOWED)},this.getSizeStyle=function(t,e){var i=t.getAttribute("width"),n=t.getAttribute("height");return null==i&&null==n?(e.width="100%",void(e.paddingBottom="56.25%")):null!=n&&null!=i?(e.height=n,void(e.width=i)):void 0},this.initVrEmbedPhoto=function(t,e){var i=document.createElement("div"),n=i.style;n.position="relative",this.getSizeStyle(t,n);var r=document.createElement("div"),s=r.style;s.position="absolute",s.top="0",s.bottom="0",s.left="0",s.right="0",s.color="white",s.fontSize="24px",s.textAlign="center";var a=document.createElement("a");r.appendChild(a),i.appendChild(r),t.appendChild(i);var u=new o;u.initVrEmbedPhoto(t),u.isStereo&&(this.isStereo=!0),this.sceneList.push(u),this.init(a,e)},this.initFromURLSource=function(t,e){var i=document.createElement("div"),n=i.style;n.position="absolute",n.width="100%",n.height="100%",n.margin="0px",n.padding="0px",n.border="0px",n.overflow="hidden",document.body.appendChild(i),document.body.style.margin="0px",document.body.style.padding="0px";var r=new o;r.initFromURLSource(t),r.isStereo&&(this.isStereo=!0),this.sceneList.push(r),this.init(i,e)},this.initStory=function(t,e){var i=t.getAttribute("noGui");null!=i&&"true"==i&&(this.noGui=!0);for(var n=t.childNodes,r=0,s=n.length;s>r;++r){var a=n[r];if(1===a.nodeType&&"SCENE"==a.nodeName){var u=new o;u.init(a),u.isStereo&&(this.isStereo=!0),this.sceneList.push(u),""!=u.name&&(this.namedSceneMap[u.name]=this.sceneList.length-1)}}this.init(t,e)},this.showShare=function(){this.vrOptions.options.showDialogShare(this.getShareCodes())},this.showOptions=function(){this.storyManager.showOptions()},this.hideOptions=function(){this.storyManager.hideOptions()},this.getStoryElement=function(){var t=document.createElement("story");for(i=0;i<this.sceneList.length;i++){var e=this.sceneList[i];t.appendChild(e.getSceneElement())}return t},this.isSinglePhotoStory=function(){return 1!=this.sceneList.length||1!=this.sceneList[0].photoObjects.length||0!=this.sceneList[0].textObjects.length?!1:!0},this.getShareCodes=function(){var t="",e="",i='<script async src="//vrEmbed.org/vrEmbed.min.js" charset="utf-8"></script>';return 1==this.isSinglePhotoStory()?(t=encodeURIComponent("http://vrembed.org/"+this.sceneList[0].photoObjects[0].getSinglePhotoURLParams()),e=this.sceneList[0].photoObjects[0].getSinglePhotoVrEmbedElement().outerHTML+i):(t=encodeURIComponent(window.location.href),e="<div>"+this.getStoryElement().outerHTML+i+"</div>"),[t,e]}},e.exports=VRStory},{"./VRDeviceManager.js":7,"./VRGui.js":8,"./VRManager.js":11,"./VROptions.js":12,"./VRRenderModes.js":13,"./VRScene.js":15,"./VRStateToggler.js":17,"./VRStates.js":18,"./VRtwglQuadStereoProjection.js":28}],20:[function(t,e,i){var n=t("./VROptions.js");VRStoryManager=function(){var t=this;this.storyList=[],this.activeStory=-1,this.vrOptions=new n;var t=this;this.onFullscreenChange_=function(e){if(null===document.webkitFullscreenElement||null===document.mozFullScreenElement)for(storyit=0;storyit<t.storyList.length;storyit++)t.storyList[storyit].stateToggler.setState(VRStates.WINDOWED)},document.addEventListener("webkitfullscreenchange",this.onFullscreenChange_.bind(this)),document.addEventListener("mozfullscreenchange",this.onFullscreenChange_.bind(this)),this.addStory=function(t){this.storyList.push(t)},this.onResize=function(){for(storyit=0;storyit<t.storyList.length;storyit++)t.storyList[storyit].onResize()},this.animate=function(){for(requestAnimationFrame(t.animate),storyit=0;storyit<t.storyList.length;storyit++)t.storyList[storyit].animate()},this.findStoryIndex=function(e){var i=-1;for(storyit=0;storyit<t.storyList.length;storyit++)t.storyList[storyit]==e&&(i=storyit);return i},this.init=function(){},this.showOptions=function(){this.vrOptions.options.showDialogOptions()},this.hideOptions=function(){this.vrOptions.options.hideDialog()},this.animate()};var r=function(){function t(){var t=new VRStoryManager;return t.init(),t}var e;return{getInstance:function(){return e||(e=t()),e}}}();e.exports=r.getInstance()},{"./VROptions.js":12}],21:[function(t,e,i){var n=t("./VRStoryManager.js"),r=t("./VRStory.js");StoryParser=function(){this.storyManager=n,this.storyManager.init(),this.parseDocXML=function(t){var e=t.getElementsByTagName("story");for(storyit=0;storyit<e.length;storyit++){var i=e[storyit],n=new r;n.initStory(i,this.storyManager),this.storyManager.addStory(n)}var s=t.getElementsByClassName("vrEmbedPhoto");for(vrEmbedPhotosIt=0;vrEmbedPhotosIt<s.length;vrEmbedPhotosIt++){var o=s[vrEmbedPhotosIt],n=new r;n.initVrEmbedPhoto(o,this.storyManager),this.storyManager.addStory(n)}},this.initFromURLSource=function(t){var e=new r;e.initFromURLSource(t,this.storyManager),this.storyManager.addStory(e)},this.onResize=function(){this.storyManager.onResize()}},e.exports=StoryParser},{"./VRStory.js":19,"./VRStoryManager.js":20}],22:[function(t,e,i){var n=t("./VRTextureDescription.js"),r=t("./VRTextOptions.js");VRText=function(){this.sceneText=null,this.textureDescription=null,this.textOptions=null,this.message="",this.parseMessage=function(t){this.message=t},this.init=function(t){this.sceneText=t,this.sceneText.setAttribute("hidden",!0),this.textureDescription=new n,this.textureDescription.setSphereParamsFromString(this.sceneText.getAttribute("sphereParams")),this.parseMessage(this.sceneText.innerHTML),this.textOptions=new r,this.textOptions.init(this.sceneText)},this.initDict=function(t){this.textureDescription=new n,this.textureDescription.initDict(t.textureDescription),this.parseMessage(t.message),this.textOptions=new r,this.textOptions.initDict(t.textOptions)},this.getTextElement=function(){var t=document.createElement("text");return t.setAttribute("sphereParams",this.textureDescription.getSphereParamsString()),t.innerHTML=this.message,this.textOptions.setElement(t),t}},e.exports=VRText},{"./VRTextOptions.js":23,"./VRTextureDescription.js":24}],23:[function(t,e,i){VRTextOptions=function(){this.align=null,this.fontface=null,this.fontsize=null,this.borderThickness=null,this.borderColor=null,this.backgroundColor=null,this.textColor=null,this.init=function(t){this.align=t.getAttribute("align"),this.fontface=t.getAttribute("fontface"),this.fontsize=t.getAttribute("fontsize"),this.borderThickness=t.getAttribute("borderthickness"),this.borderColor=t.getAttribute("bordercolor"),this.backgroundColor=t.getAttribute("backgroundcolor"),this.textColor=t.getAttribute("textcolor")},this.initDict=function(t){this.align=t.align,this.fontface=t.fontface,this.fontsize=t.fontsize,this.borderThickness=t.borderthickness,this.borderColor=t.bordercolor,this.backgroundColor=t.backgroundcolor,this.textColor=t.textcolor},this.setElement=function(t){null!=this.align&&t.setAttribute("align",this.align),null!=this.fontface&&t.setAttribute("fontface",this.fontface),null!=this.fontsize&&t.setAttribute("fontsize",this.fontsize),null!=this.borderThickness&&t.setAttribute("borderthickness",this.borderThickness),null!=this.borderColor&&t.setAttribute("bordercolor",this.borderColor),null!=this.backgroundColor&&t.setAttribute("backgroundcolor",this.backgroundColor),null!=this.textColor&&t.setAttribute("textcolor",this.textColor)}},e.exports=VRTextOptions},{}],24:[function(t,e,i){VRTextureDescription=function(){this.textureSource="",this.metaSource="",this.isStereo=!1,this.sphereFOV=[360,180],this.sphereCentre=[0,0],this.U_l=[0,0],this.V_l=[1,1],this.U_r=[0,0],this.V_r=[1,1],this.plane=!1,this.setSphereParamsFromString=function(t){var e=t.split(",");this.sphereFOV=[e[0].trim(),e[1].trim()],this.sphereCentre=[e[2].trim(),e[3].trim()]},this.setTexParamsFromString=function(t){var e=t.split(",");this.U_l=[e[0].trim(),e[1].trim()],this.V_l=[e[2].trim(),e[3].trim()],this.U_r=[e[4].trim(),e[5].trim()],this.V_r=[e[6].trim(),e[7].trim()]},this.getSphereParamsString=function(){return this.sphereFOV[0]+","+this.sphereFOV[1]+","+this.sphereCentre[0]+","+this.sphereCentre[1]},this.getTexParamsString=function(){return this.U_l[0]+","+this.U_l[1]+","+this.V_l[0]+","+this.V_l[1]+","+this.U_r[0]+","+this.U_r[1]+","+this.V_r[0]+","+this.V_r[1]},this.getAbsoluteTexturePath=function(){var t=document.createElement("a");return t.href=this.textureSource,t.protocol+"//"+t.host+t.pathname+t.search+t.hash},this.initDict=function(t){return this.textureSource=t.src,null==this.textureSource?void(this.textureSource=null):(this.metaSource="",this.isStereo=t.isStereo,this.plane=t.plane,this.sphereFOV=t.sphereFOV,this.sphereCentre=t.sphereCentre,void(this.isStereo&&(this.U_l=t.U_l,this.V_l=t.V_l,this.U_r=t.U_r,this.V_r=t.V_r)))}},e.exports=VRTextureDescription},{}],25:[function(t,e,i){function n(){var t=window.location.search.substr(1);return null!=t&&""!=t?r(t):{}}function r(t){for(var e={},i=t.split("&"),n=0;n<i.length;n++){var r=i[n].split("=");e[r[0]]=decodeURIComponent(r[1])}return e}var s=t("./VRScenePhoto.js");VRURLParser=function(){this.isEditor=!1,this.params=[],this.scenePhoto=null,this.parseURL=function(){this.params=n()},this.init=function(){var t=document.getElementsByTagName("vrEditor");this.parseURL();var e=0;for(var i in this.params)e+=1;return 0!=t.length&&0!=e&&(this.scenePhoto=new s,this.scenePhoto.initFromURL(this.params),null!=this.scenePhoto.textureDescription)?(this.isEditor=!0,this.scenePhoto):null}},e.exports=VRURLParser},{"./VRScenePhoto.js":16}],26:[function(t,e,i){function n(){this.isMobile=function(){var t=!1;return function(e){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4)))&&(t=!0)}(navigator.userAgent||navigator.vendor||window.opera),t}}e.exports=n},{}],27:[function(t,e,i){var n=t("../js-ext/twgl-full.js");VRtwglQuad=function(){var t=this;this.container=null,this.canvas=null,this.canvas2d=null,this.glContext=null,this.programInfo=null,this.bufferInfo=null,this.parentElement=null,this.uniforms=null,this.fbSize=2048,this.canvas2dWidth=2048,this.canvas2dHeight=2048,this.viewportDims=[0,0],this.isFullScreen=!1,this.initCore=function(t,e){this.programInfo=n.createProgramInfo(this.glContext,[t,e]);var i={position:[-1,-1,0,1,-1,0,-1,1,0,-1,1,0,1,-1,0,1,1,0]};this.bufferInfo=n.createBufferInfoFromArrays(this.glContext,i)},this.init=function(t,e,i){this.parentElement=t.parentNode,this.container=document.createElement("div"),this.container.style.margin=0,this.container.style.padding="0px",this.canvas=document.createElement("canvas"),this.canvas2d=document.createElement("canvas");var r=this.canvas.style;r.display="block",r.position="absolute";var s=this.canvas2d.style;s.position="absolute",s.marginLeft="auto",s.marginRight="auto",s.backgroundSize="cover",s.backgroundColor="transparent",s.border=0,s.userSelect="none",s.webkitUserSelect="none",s.MozUserSelect="none",s.opacity="1.0",s.left=0,s.right=0,s.top="0px",s.height="100%",s.width="100%",this.container.appendChild(this.canvas),this.container.appendChild(this.canvas2d),t.appendChild(this.container),this.glContext=n.getWebGLContext(this.canvas),this.initCore(e,i)},this.setCanvasFullscreen=function(){var t=this.canvas.style;t.position="relative";var e=this.canvas2d.style;e.height="100vh",e.width="100vw",this.isFullScreen=!0},this.setCanvasWindowed=function(){var t=this.canvas.style;t.position="absolute";var e=this.canvas2d.style;e.height="100%",e.width="100%",this.isFullScreen=!1},this.initFramebuffer=function(t,e,i,r){this.glContext=e,this.fbSize=t,this.canvas2dWidth=t,this.canvas2dHeight=t,this.initCore(i,r);var s=[{format:this.glContext.RGBA,type:this.glContext.UNSIGNED_BYTE,min:this.glContext.LINEAR,mag:this.glContext.LINEAR,wrap:this.glContext.CLAMP_TO_EDGE}];this.framebufferInfo=n.createFramebufferInfo(this.glContext,s,this.fbSize,this.fbSize)},this.createImageFromTexture=function(){var t=this.glContext,e=this.getFramebufferTexture(),i=this.fbSize,n=this.fbSize,r=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,r),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e,0);var s=new Uint8Array(i*n*4);t.readPixels(0,0,i,n,t.RGBA,t.UNSIGNED_BYTE,s),t.deleteFramebuffer(r);var o=document.createElement("canvas");o.width=i,o.height=n;var a=o.getContext("2d"),u=a.createImageData(i,n);return u.data.set(s),a.putImageData(u,0,0),o.toDataURL()},this.getFramebufferTexture=function(){return this.framebufferInfo.attachments[0]},this.getFramebufferSize=function(){return this.fbSize},this.getDevicePixelRatio=function(){return window.devicePixelRatio||1},this.fixViewportSize=function(){var e=t.glContext.canvas,i=window.innerWidth,n=window.innerHeight;this.isFullScreen||(i=t.parentElement.clientWidth,n=t.parentElement.clientHeight);var r=this.getDevicePixelRatio();e.width=Math.floor(i*r),e.height=Math.floor(n*r),e.style.width=i+"px",e.style.height=n+"px",t.glContext.viewport(0,0,Math.floor(i*r),Math.floor(n*r))},this.resize=function(){this.fixViewportSize();var e=t.parentElement.clientWidth,i=t.parentElement.clientHeight,n=this.canvas2d.getContext("2d");this.canvas2dHeight=Math.floor(this.canvas2dWidth*i/e),n.canvas.width=this.canvas2dWidth,n.canvas.height=this.canvas2dHeight},this.setUniforms=function(t){this.uniforms=t},this.render=function(){n.resizeCanvasToDisplaySize(t.glContext.canvas,t.getDevicePixelRatio()),t.glContext.useProgram(t.programInfo.program),n.setBuffersAndAttributes(t.glContext,t.programInfo,t.bufferInfo),n.setUniforms(t.programInfo,this.uniforms),n.drawBufferInfo(t.glContext,t.glContext.TRIANGLES,t.bufferInfo)},this.get2dContext=function(){return null==t.canvas2d?null:[t.canvas2d.getContext("2d"),t.canvas2dWidth,t.canvas2dHeight]},this.clearFrameBuffer=function(e,i,r,s){n.bindFramebufferInfo(t.glContext,t.framebufferInfo),this.glContext.clearColor(e,i,r,s),this.glContext.clear(this.glContext.COLOR_BUFFER_BIT),n.bindFramebufferInfo(t.glContext,null)},this.renderFramebuffer=function(){n.bindFramebufferInfo(t.glContext,t.framebufferInfo),this.render(),n.bindFramebufferInfo(t.glContext,null)},this.resetViewport=function(){var e=t.getDevicePixelRatio(),i=t.parentElement.clientWidth,n=t.parentElement.clientHeight;t.glContext.viewport(0,0,Math.floor(i*e),Math.floor(n*e))}},e.exports=VRtwglQuad},{"../js-ext/twgl-full.js":3}],28:[function(t,e,i){VRtwglQuad=t("./VRtwglQuad.js"),VRRenderModes=t("./VRRenderModes.js"),VRLookController=t("./VRControllers.js"),VRDeviceManager=t("./VRDeviceManager.js"),VRCanvasFactory=t("./VRCanvasFactory.js"),VRRotMath=t("./VRRotMath.js"),Util=t("./VRUtil.js"),twgl=t("../js-ext/twgl-full.js");var n="precision highp float;\nattribute vec4 position;\nvoid main() {\n  gl_Position = position;\n}\n",r="precision highp float;\n#define PI 3.141592653589793\nuniform vec2 resolution;\nuniform sampler2D textureSource;\nuniform sampler2D textureGui;\nuniform mat4 transform;\nuniform int renderMode;\nuniform vec2 fovParams;\nuniform vec2 k;\nuniform float ipdAdjust;\nuniform float guiMult;\nvoid main(void) {\n  vec2 uv = gl_FragCoord.xy / resolution;\n  uv.x = (1. - uv.x);\n  bool leftImg=false;\n  vec2 fov = fovParams;\n  if (renderMode == 1) {\n    fov.y *= 2.;\n    if (uv.x<0.5) { \n      uv.x *= 2.; \n      uv.x += ipdAdjust;\n      leftImg=true; }\n    else {\n      uv.x = 2.*(uv.x - .5);\n      uv.x -= ipdAdjust;\n    }\n    float r2 = (uv.x-0.5)*(uv.x-0.5) + (uv.y-0.5)*(uv.y-0.5);\n    uv.x = 0.5+(uv.x-0.5)*(1. + k.x*r2 + k.y*r2*r2);\n    uv.y = 0.5+(uv.y-0.5)*(1. + k.x*r2 + k.y*r2*r2);\n    uv.x = 0.5+fov.x*(uv.x-0.5);\n    uv.y = 0.5+fov.y*(uv.y-0.5);\n  } else {\n    uv.x = 0.5+fov.x*(uv.x-0.5);\n    uv.y = 0.5+fov.y*(uv.y-0.5);\n  }\n  float lat = 0.5*PI*(2.*uv.y-1.0);\n  float lon = PI*(2.0*uv.x-1.0);\n  float r = cos(lat);\n  vec4 sphere_pnt = vec4(r*cos(lon), r*sin(lon), sin(lat), 1.0);\n  sphere_pnt *= transform;\n  float sphere_pnt_len = length(sphere_pnt);\n  vec2 lonLat = vec2(atan(sphere_pnt.y, sphere_pnt.x), asin(sphere_pnt.z));\n  lonLat.x = (lonLat.x/(2.0*PI))+0.5;\n  lonLat.y = (lonLat.y/(PI))+0.5;\n  if (renderMode != 2) {\n    if (renderMode == 0) {\n      lonLat.y *= 0.5;\n    } else {\n      if (leftImg == true) {\n        lonLat.y *= 0.5;\n      } else {\n        lonLat.y = 0.5 + lonLat.y*0.5;\n      }\n    }\n    vec4 spherePx = texture2D(textureSource, lonLat);\n    vec4 guiPx = texture2D(textureGui, lonLat);\n    guiPx.a *= guiMult;\n    gl_FragColor = guiPx*guiPx.a + spherePx*(1.-guiPx.a);\n  } else if (renderMode == 2) {\n    vec4 colorL, colorR, colorLSphere, colorLGui, colorRSphere, colorRGui;\n    colorLSphere = texture2D(textureSource, vec2(lonLat.x, lonLat.y*0.5));\n    colorLGui = texture2D(textureGui, vec2(lonLat.x, lonLat.y*0.5));\n    colorLGui.a *= guiMult;\n    colorL = colorLGui*colorLGui.a + colorLSphere*(1.-colorLGui.a);\n    colorRSphere = texture2D(textureSource, vec2(lonLat.x, 0.5+lonLat.y*0.5));\n    colorRGui = texture2D(textureGui, vec2(lonLat.x, 0.5+lonLat.y*0.5));\n    colorRGui.a *= guiMult;\n    colorR = colorRGui*colorRGui.a + colorRSphere*(1.-colorRGui.a);\n    gl_FragColor = vec4( colorL.g * 0.7 + colorL.b * 0.3, colorR.g, colorR.b, colorL.a + colorR.a ) * 1.1;\n  }\n}\n",s="precision highp float;\n#define PI 3.141592653589793\nuniform vec2 resolution;\nuniform sampler2D textureSource;\nuniform mat4 transform;\nuniform vec2 sphX;\nuniform vec2 sphYX;\nuniform vec4 uvL;\nuniform vec4 uvR;\nuniform float planar;\nvoid uvToSphere(in vec2 uv, out vec4 sphere_pnt) {\n  float lon = PI*(2.0*uv.x-1.0);\n  float lat = 0.5*PI*(2.*uv.y-1.0);\n  float r = cos(lat);\n  sphere_pnt = vec4(r*cos(lon), r*sin(lon), sin(lat), 1.0);\n}\nvoid main(void) {\n  //normalize uv so it is between 0 and 1\n  vec2 uv = gl_FragCoord.xy / resolution;\n  bool leftImg=false;\n  if (uv.y<0.5) { \n    uv.y *= 2.; \n    leftImg=true; }\n  else {\n    uv.y = 2.*(uv.y - .5);\n  }\n  vec4 sphere_pnt;\n  uvToSphere(uv, sphere_pnt);\n  sphere_pnt *= transform;\n  float sphere_pnt_len = length(sphere_pnt);\n  vec2 lonLat;\n  if (planar<0.5) {\n    lonLat = vec2(atan(sphere_pnt.y, sphere_pnt.x), asin(sphere_pnt.z));\n  } else {\n    lonLat = vec2(0.25*PI*sphere_pnt.y/sphere_pnt.x, 0.25*PI*sphere_pnt.z/sphere_pnt.x);\n    if (sphere_pnt.x<0. || abs(lonLat.x)>PI || abs(lonLat.y)>0.5*PI){ discard; return;}\n  }\n  lonLat.x = (lonLat.x/(2.0*PI))+0.5;\n  lonLat.y = (lonLat.y/(PI))+0.5;\n  vec2 testPt = (lonLat-sphX);\n  testPt = mod(testPt, 1.)/sphYX;\n  // bail out if we're out of drawable region\n  if (testPt.x<0. || testPt.x>1. || testPt.y<0. || testPt.y>1.){ discard; return;}\n  // now map to either left or right UV tex\n  vec2 uvX;\n  vec2 uvYX;\n  if (leftImg == true) {\n    uvX = uvL.xy;\n    uvYX = uvL.zw;\n  } else {\n    uvX = uvR.xy;\n    uvYX = uvR.zw;\n  }\n  vec2 texC = uvX + (testPt*uvYX);\n  gl_FragColor = texture2D(textureSource, texC); \n}\n";
VRtwglQuadStereoProjection=function(){var t=this;this.vrDeviceManager=VRDeviceManager,this.vrtwglQuad=null,this.vrtwglQuadFb=null,this.vrtwglQuadFbGui=null,this.textureSet=[],this.textureDescriptions={},this.textures=[],this.fovX=40,this.tick=0,this.vrGui=null,this.controller=new VRLookController,this.cameraMatrix=twgl.m4.identity(),this.controller.setCamera(this.cameraMatrix),this.textureLoadStartAnim=Date.now(),this.textureLoadEndAnim=this.textureLoadStartAnim+1e3,this.texReady=!1,this.rotMath=new VRRotMath,this.pickResolution=function(){var t=document.createElement("canvas"),e=twgl.getWebGLContext(t),i=e.getParameter(e.MAX_TEXTURE_SIZE);return t.remove(),1024>=i?1024:2048>=i?2048:4096},this.fbRes=this.pickResolution(),this.getContainer=function(){return this.vrtwglQuad.container},this.getDrawCanvas=function(){return this.vrtwglQuad.canvas},this.getContext=function(){return this.vrtwglQuad.glContext},this.setVrGui=function(t){this.vrGui=t},this.uniforms={resolution:[0,0],fovParams:[0,0],textureSource:null,textureGui:null,transform:twgl.m4.identity(),renderMode:VRRenderModes.STEREOSIDEBYSIDE,k:[0,0],ipdAdjust:0,guiMult:.6},this.uniformsFb={resolution:[this.fbRes,this.fbRes],textureSource:null,transform:twgl.m4.identity(),planar:0},this.uniformsFbGui={resolution:[this.fbRes,this.fbRes],textureSource:null,transform:twgl.m4.identity(),planar:1},this.setupFromDevice=function(t){this.uniforms.renderMode=t.renderMode,this.fovX=t.hfov,this.uniforms.k=t.k,this.uniforms.ipdAdjust=t.ipdAdjust},this.getRenderMode=function(){return this.uniforms.renderMode},this.getIPDAdjust=function(){return this.uniforms.ipdAdjust},this.init=function(e){this.vrtwglQuad=new VRtwglQuad,this.vrtwglQuad.init(e,n,r),this.setupFromDevice(this.vrDeviceManager.getWindowedDevice()),this.vrtwglQuadFb=new VRtwglQuad,this.vrtwglQuadFb.initFramebuffer(this.fbRes,this.vrtwglQuad.glContext,n,s),t.vrtwglQuadFb.clearFrameBuffer(0,0,0,1),this.vrtwglQuadFbGui=new VRtwglQuad,this.vrtwglQuadFbGui.initFramebuffer(this.fbRes,this.vrtwglQuad.glContext,n,s),t.vrtwglQuadFbGui.clearFrameBuffer(0,0,0,0),t.vrtwglQuad.resetViewport()},this.createImageFromSphereTexture=function(){return this.vrtwglQuadFb.createImageFromTexture()},this.renderGui=function(){if(null==this.vrGui)return void console.log("ERROR: trying to render before gui is ready");for(t.vrtwglQuadFbGui.clearFrameBuffer(0,0,0,0),texIt=0;texIt<t.vrGui.canvasSet.length;texIt++){var e=t.vrGui.canvasSet[texIt][0],i=e.vrTextureDescription;e.update(t.tick),t.uniformsFbGui.textureSource=e.glTex,t.uniformsFbGui.sphX=[.5-.5*(i.sphereFOV[0]/360),.5-.5*(i.sphereFOV[1]/180)],t.uniformsFbGui.sphYX=[i.sphereFOV[0]/360,i.sphereFOV[1]/180],t.uniformsFbGui.transform=t.createOrientation(Math.PI*i.sphereCentre[0]/180,Math.PI*i.sphereCentre[1]/180),t.uniformsFbGui.uvL=[i.U_l[0],i.U_l[1],i.V_l[0]-i.U_l[0],i.V_l[1]-i.U_l[1]],t.uniformsFbGui.uvR=[i.U_r[0],i.U_r[1],i.V_r[0]-i.U_r[0],i.V_r[1]-i.U_r[1]],i.plane?t.uniformsFbGui.planar=1:t.uniformsFbGui.planar=0,t.renderFbGui()}t.vrtwglQuad.resetViewport()},this.resize=function(){t.vrtwglQuad.resize()},this.guiToLonLat=function(t){var e=this.uniforms,i=[t[0],t[1]];i[0]=1-i[0];var n=!1,r=[e.fovParams[0],e.fovParams[1]],s=e.k,o=e.renderMode,a=e.ipdAdjust;if(1==o){r[1]*=2,i[0]<.5?(i[0]*=2,i[0]+=a,n=!0):(i[0]=2*(i[0]-.5),i[0]-=a);var u=(i[0]-.5)*(i[0]-.5)+(i[1]-.5)*(i[1]-.5);i[0]=.5+(i[0]-.5)*(1+s[0]*u+s[1]*u*u),i[1]=.5+(i[1]-.5)*(1+s[0]*u+s[1]*u*u),i[0]=.5+r[0]*(i[0]-.5),i[1]=.5+r[1]*(i[1]-.5)}else i[0]=.5+r[0]*(i[0]-.5),i[1]=.5+r[1]*(i[1]-.5);var A=Math.PI*(2*i[0]-1),c=.5*Math.PI*(2*i[1]-1),l=Math.cos(c),h=[l*Math.cos(A),l*Math.sin(A),Math.sin(c)];h=twgl.m4.transformPoint(e.transform,h);var d=[Math.atan2(h[1],h[0]),Math.asin(h[2])];return[180*d[0]/Math.PI,180*d[1]/Math.PI]},this.getGuiMult=function(){return this.uniforms.guiMult},this.setGuiMult=function(t){this.uniforms.guiMult=t},this.render=function(){this.controller.update(),twgl.m4.copy(this.cameraMatrix,this.uniforms.transform),this.uniforms.resolution=[t.vrtwglQuad.canvas.width,t.vrtwglQuad.canvas.height];var e=2*t.vrtwglQuad.canvas.height/t.vrtwglQuad.canvas.width;this.uniforms.fovParams=[this.fovX/360,e*this.fovX/360],this.uniforms.textureSource=t.vrtwglQuadFb.getFramebufferTexture(),this.uniforms.textureGui=t.vrtwglQuadFbGui.getFramebufferTexture(),t.vrtwglQuad.setUniforms(this.uniforms),t.vrtwglQuad.render()},this.renderFb=function(){t.vrtwglQuadFb.setUniforms(this.uniformsFb),t.vrtwglQuadFb.renderFramebuffer()},this.renderFbGui=function(){t.vrtwglQuadFbGui.setUniforms(this.uniformsFbGui),t.vrtwglQuadFbGui.renderFramebuffer()},this.anim=function(){t.render(),requestAnimationFrame(t.anim)},this.createOrientation=function(t,e){return this.rotMath.rotateZX(t,e)},this.texturesLoaded=function(e,i,n){void 0!=e&&alert(e);var r=t.vrtwglQuad.glContext;r.enable(r.BLEND),r.blendFunc(r.SRC_ALPHA,r.ONE_MINUS_SRC_ALPHA),t.vrtwglQuadFb.clearFrameBuffer(0,0,0,1);for(var s in t.textures)if(t.textures.hasOwnProperty(s)){var o=t.textureDescriptions[s];t.uniformsFb.textureSource=t.textures[s],t.uniformsFb.sphX=[.5-.5*(o.sphereFOV[0]/360),.5-.5*(o.sphereFOV[1]/180)],t.uniformsFb.sphYX=[o.sphereFOV[0]/360,o.sphereFOV[1]/180],t.uniformsFb.transform=t.createOrientation(Math.PI*o.sphereCentre[0]/180,Math.PI*o.sphereCentre[1]/180),t.uniformsFb.uvL=[o.U_l[0],o.U_l[1],o.V_l[0]-o.U_l[0],o.V_l[1]-o.U_l[1]],t.uniformsFb.uvR=[o.U_r[0],o.U_r[1],o.V_r[0]-o.U_r[0],o.V_r[1]-o.U_r[1]],o.plane?t.uniformsFb.planar=1:t.uniformsFb.planar=0,t.renderFb(),r.deleteTexture(t.textures[s])}t.vrtwglQuad.resetViewport(),t.resize(),t.texReady=!0,t.textureLoadStartAnim=Date.now(),t.textureLoadEndAnim=t.textureLoadStartAnim+250},this.loadTextures=function(e){var i=t.vrtwglQuad.glContext,n=[];for(texIt=0;texIt<e.length;texIt++){var r={min:i.LINEAR,mag:i.LINEAR,src:e[texIt].textureSource,crossOrigin:""};n[texIt]=r,this.textureDescriptions[texIt]=e[texIt]}this.texReady=!1,this.textureLoadStartAnim=Date.now(),this.textureLoadEndAnim=this.textureLoadStartAnim+1e3;var i=t.vrtwglQuad.glContext;this.textures=twgl.createTextures(i,n,this.texturesLoaded)},this.teardown=function(){this.textures=[],this.textureDescriptions=[]}},e.exports=VRtwglQuadStereoProjection},{"../js-ext/twgl-full.js":3,"./VRCanvasFactory.js":5,"./VRControllers.js":6,"./VRDeviceManager.js":7,"./VRRenderModes.js":13,"./VRRotMath.js":14,"./VRUtil.js":26,"./VRtwglQuad.js":27}],29:[function(t,e,i){function n(){l.onResize()}var r=t("./VRStoryParser.js"),s=t("./VRURLParser.js"),o=t("./VRStoryManager.js"),a=t("../js-ext/domready.js"),u=function(){function t(){window.VRURLPARSER_INIT=!0;var t=new s;return t}var e;return{getInstance:function(){return e||(e=t()),e}}}(),A=function(){function t(){function t(){i.onResize()}function e(){i.parseDocXML(document.body)}window.VRSTORYPARSER_INIT=!0;var i=new r;return window.addEventListener("resize",t,!1),a(e),i}var e;return{getInstance:function(){return e||(e=t()),e}}}();if(!window.VRURLPARSER_INIT){var c=u.getInstance();if(c.init(),1==c.isEditor){window.stop(),document.body.innerHTML="",window.VRSTORYPARSER_INIT=!0;var l=new r;return window.addEventListener("resize",n,!1),void l.initFromURLSource(c.scenePhoto)}}if(!window.VRSTORYPARSER_INIT){!function(t,e,i,n,r,s,o){t.GoogleAnalyticsObject=r,t[r]=t[r]||function(){(t[r].q=t[r].q||[]).push(arguments)},t[r].l=1*new Date,s=e.createElement(i),o=e.getElementsByTagName(i)[0],s.async=1,s.src=n,o.parentNode.insertBefore(s,o)}(window,document,"script","//www.google-analytics.com/analytics.js","ga"),ga("create","UA-73312245-1","auto"),ga("send","pageview");var l=A.getInstance();e.exports=o}},{"../js-ext/domready.js":1,"./VRStoryManager.js":20,"./VRStoryParser.js":21,"./VRURLParser.js":25}]},{},[29])(29)});
